import{f as e,h as t,j as n,t as r}from"./chunks/plugin-vue_export-helper.Dz-VHcSB.js";const i=JSON.parse(`{"title":"Cryptography","description":"Cryptography involves converting sensitive data into a format that is unreadable for an unauthorised user","frontmatter":{"title":"Cryptography","description":"Cryptography involves converting sensitive data into a format that is unreadable for an unauthorised user"},"headers":[],"relativePath":"Concepts/Application_Security/Cryptography.md","filePath":"Concepts/Application_Security/Cryptography.md","lastUpdated":1767053997000}`);var a={name:`Concepts/Application_Security/Cryptography.md`};function o(r,i,a,o,s,c){return n(),e(`div`,null,[...i[0]||=[t(`<h1 id="cryptography" tabindex="-1">Cryptography <a class="header-anchor" href="#cryptography" aria-label="Permalink to â€œCryptographyâ€">â€‹</a></h1><p>It is the practice and study of techniques for secure communication in the presence of adversarial behaviour</p><ul><li>Cryptography involves converting sensitive data into a format that is unreadable for an unauthorized user</li></ul><h2 id="hashing" tabindex="-1">Hashing <a class="header-anchor" href="#hashing" aria-label="Permalink to â€œHashingâ€">â€‹</a></h2><p>Hashing is one-way operation that produces a message digest</p><ul><li><p>Used for message integrity, digital signatures &amp; storing passwords</p></li><li><p>A salt (some random value) is added to the value before hashing it</p></li><li><p>Salting is important to protect against offline password attacks (e.g. <strong>Rainbow Tables</strong>)</p></li><li><p>Infeasible to reverse the output</p></li><li><p>Timing attacks can be used to hack</p></li></ul><blockquote><p>Hash means to chop and mix (in Culinary Terms)</p></blockquote><p><em>Example:</em></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> createHash</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> }</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> require</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">crypto</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">// Create a string hash</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">function</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> hash</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#E36209;">input</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">)</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">  // returns a hash value (also called digest) of size 256-bit</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> createHash</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">sha256</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">).</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">update</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">input</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">).</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">digest</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">hex</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;"> // &#39;base64&#39; can also be used</span></span>
<span class="line"><span style="--shiki-dark:#666666;--shiki-light:#24292E;">}</span></span></code></pre></div><ul><li>Salting:</li></ul><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> scryptSync</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> randomBytes</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> timingSafeEqual</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> }</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> require</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">crypto</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">function</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> signup</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#E36209;">email</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#E36209;"> password</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">)</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> salt</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> randomBytes</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">16</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">).</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">toString</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">hex</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> hashedPassword</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> scryptSync</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">password</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> salt</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;"> 64</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> user</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> email</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#B8A965;--shiki-light:#24292E;"> password</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">:</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> \`</span><span style="--shiki-dark:#4D9375;--shiki-light:#032F62;">\${</span><span style="--shiki-dark:#C98A7D;--shiki-light:#24292E;">salt</span><span style="--shiki-dark:#4D9375;--shiki-light:#032F62;">}</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">:</span><span style="--shiki-dark:#4D9375;--shiki-light:#032F62;">\${</span><span style="--shiki-dark:#C98A7D;--shiki-light:#24292E;">hashedPassword</span><span style="--shiki-dark:#4D9375;--shiki-light:#032F62;">}</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">\`</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">  users</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">push</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">user</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> user</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#666666;--shiki-light:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">function</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> login</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#E36209;">email</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#E36209;"> password</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">)</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> user</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> users</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">find</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">((</span><span style="--shiki-dark:#BD976A;--shiki-light:#E36209;">v</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">)</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =&gt;</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> v</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">email</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> ===</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> email</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> [</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;">salt</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> key</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">]</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> user</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">password</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">split</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">:</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> hashedBuffer</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> scryptSync</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">password</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> salt</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;"> 64</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> keyBuffer</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> Buffer</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">from</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">key</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">hex</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">  const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> match</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> timingSafeEqual</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">hashedPassword</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> keyBuffer</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">  if</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">match</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">)</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> return</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">login success!</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">  return</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">login fail!</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#666666;--shiki-light:#24292E;">}</span></span></code></pre></div><ul><li><strong>Key Derivation</strong></li></ul><p><em>Example:</em></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">// the secret message is: JavaScript</span></span>
<span class="line"><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">md5Hash</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">686155af75a60a0f6e9d80c1f7edd3e9</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">shaHash</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">b6e13ad53d8ec41b034c49f131c64e99cf25207a</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">sha256Hash</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">eda71746c01c3f465ffd02b6da15a6518e6fbc8f06f1ac525be193be5507069d</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">sha512Hash</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span></span>
<span class="line"><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">  &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">6179a35e21da636ce44afd549e01cce9e54952f3f7ec40060698a3f58aeb1a5a4e3e82164ee22394d362fdd845570e8df86053bc051b9e3ae6fa4290504579c7</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">;</span></span></code></pre></div><h3 id="hash-based-message-authentication-code-hmac" tabindex="-1">Hash-Based Message Authentication Code (HMAC) <a class="header-anchor" href="#hash-based-message-authentication-code-hmac" aria-label="Permalink to â€œHash-Based Message Authentication Code (HMAC)â€">â€‹</a></h3><p>Hashing is used to provide data integrity</p><ul><li><p>Message Authentication Code (MAC) is a concept of combining Message + Secret Key when calculating Digest</p></li><li><p>Provides <em>Integrity</em> and <em>Authentication</em> for bulk data transfer</p></li><li><p>Industry standard implementation of MAC: HAMC (RFC 2104)</p><ul><li>A hash that requires a password (shared key)</li></ul></li><li><p>Example is JWT</p></li></ul><p><em>Example:</em></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> createHmac</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> }</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> require</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">crypto</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> key</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">super-secret!</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> message</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">boo ðŸ‘»</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> hmac</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> createHmac</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">sha256</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> key</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">).</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">update</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">message</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">).</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">digest</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">hex</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span></code></pre></div><h2 id="encryption" tabindex="-1">Encryption <a class="header-anchor" href="#encryption" aria-label="Permalink to â€œEncryptionâ€">â€‹</a></h2><p>Encryption turns plaintext into ciphertext (and vice-versa):</p><ul><li><p>Requires an algorithm and a key</p></li><li><p><a href="#symmetric-encryption">Symmetric</a> algorithms use the same key for both encryption and decryption</p></li><li><p>[Asymmetric] (or public key) algorithms use different keys for encryption (the public key) and decryption (the private key)</p></li></ul><ol><li>Encryption At Rest</li><li>Encryption Transit</li></ol><h3 id="symmetric-encryption" tabindex="-1">Symmetric Encryption <a class="header-anchor" href="#symmetric-encryption" aria-label="Permalink to â€œSymmetric Encryptionâ€">â€‹</a></h3><p>Symmetric encryption uses a single key to encrypt and decrypt</p><ul><li>Key needs to be shared</li><li>Which makes it less secure</li></ul><p>2 Types:</p><ul><li><p>Block ciphers encrypt a fixed size of n-bits of data at a time (e.g. DES, 3DES, AES)</p><ul><li>AES (Advanced Encryption Standard)</li></ul></li><li><p>Stream ciphers encrypt 1 byte of data at a time</p></li></ul><p>Block ciphers support different modes of operation:</p><ul><li><p>Electronic Code Block (ECB):</p><ul><li><p>Less secure than others</p></li><li><p>Android uses ECB by default when using AES:</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">Cipher</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">getInstance</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">AES</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">// Use</span></span>
<span class="line"><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">Cipher</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">getInstance</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">AES/GCM/NOPADDING</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span></code></pre></div></li></ul></li><li><p>Cipher Block Chaining (CBC)</p></li></ul><p><em>Example:</em> Symmetric encryption</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> createCipheriv</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> randomBytes</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> createDecipheriv</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> }</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> require</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">crypto</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">// Cipher</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> message</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">i like turtles</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> key</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> randomBytes</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">32</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> iv</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> randomBytes</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">16</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> cipher</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> createCipheriv</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">aes256</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> key</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> iv</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">// Encrypt</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> encryptedMessage</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> cipher</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">update</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">message</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">utf-8</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">hex</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">)</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> +</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> cipher</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">final</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">hex</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">// Decrypt</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> decipher</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> createDecipheriv</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">aes256</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> key</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> iv</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> decryptedMessage</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> decipher</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">update</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">encryptedMessage</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">hex</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">utf-8</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">)</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> +</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> cipher</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">final</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">utf-8</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">console</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">log</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">decryptedMessage</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">toString</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">utf-8</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">));</span></span></code></pre></div><ul><li><em>IV</em> stands from Initialization Vector: Prevent identical sequence of text</li></ul><h3 id="asymmetric-encryption-public-key-cryptography" tabindex="-1">Asymmetric Encryption / Public-Key Cryptography <a class="header-anchor" href="#asymmetric-encryption-public-key-cryptography" aria-label="Permalink to â€œAsymmetric Encryption / Public-Key Cryptographyâ€">â€‹</a></h3><p>Asymmetric Encryption encrypts and decrypts the data using two separate yet mathematically connected cryptographic keys</p><ul><li><p>The Private Key is intended to be private so that only the authenticated recipient can decrypt the message</p></li><li><p>The Public Key is shared with users how intend to encrypt the message</p></li><li><p>Message longer than public key cannot be encrypted using the public key. This is an <strong>important limitation</strong>.</p></li><li><p>HTTPS performs key exchange (using public and private keys to generate symmetric key) and then encrypt any data larger than the public key using the resulting symmetric key</p></li></ul><p><em>Example:</em></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> generateKeyPairSync</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> }</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> require</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">crypto</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> privateKey</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> publicKey</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> }</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> generateKeyPairSync</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">rsa</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#B8A965;--shiki-light:#24292E;">  modulusLength</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">:</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;"> 2048</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;"> // the length of your key in bits</span></span>
<span class="line"><span style="--shiki-dark:#B8A965;--shiki-light:#24292E;">  publicKeyEncoding</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">:</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#B8A965;--shiki-light:#24292E;">    type</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">:</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">spki</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;"> // recommended to be &#39;spki&#39; by Node.js docs,</span></span>
<span class="line"><span style="--shiki-dark:#B8A965;--shiki-light:#24292E;">    format</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">:</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">pem</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#666666;--shiki-light:#24292E;">  },</span></span>
<span class="line"><span style="--shiki-dark:#B8A965;--shiki-light:#24292E;">  privateKeyEncoding</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">:</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span></span>
<span class="line"><span style="--shiki-dark:#B8A965;--shiki-light:#24292E;">    type</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">:</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">pkcs8</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;"> // recommended to be &#39;pkcs8&#39; by Node.js docs,</span></span>
<span class="line"><span style="--shiki-dark:#B8A965;--shiki-light:#24292E;">    format</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">:</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">pem</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">    // cipher: &quot;aes-256-cbc&quot;,</span></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">    // passphrase: &quot;top secret&quot;,</span></span>
<span class="line"><span style="--shiki-dark:#666666;--shiki-light:#24292E;">  },</span></span>
<span class="line"><span style="--shiki-dark:#666666;--shiki-light:#24292E;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> publicEncrypt</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> privateDecrypt</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> }</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> require</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">crypto</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> message</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">the germans are coming!</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> encryptedData</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> publicEncrypt</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">publicKey</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> Buffer</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">from</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">message</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">console</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">log</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">encryptedData</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">toString</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">hex</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> decryptedData</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> privateDecrypt</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">privateKey</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> encryptedData</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">console</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">log</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">decryptedData</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">toString</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">utf-8</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">));</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;"># using openssl to generate RSA public and private key</span></span>
<span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">openssl</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> genrsa</span></span></code></pre></div><h2 id="encryption-in-transit" tabindex="-1">Encryption in Transit <a class="header-anchor" href="#encryption-in-transit" aria-label="Permalink to â€œEncryption in Transitâ€">â€‹</a></h2><ul><li><p>Transport Layer Security (TLS): for end-to-end encryption (over HTTP)</p></li><li><p>Not only protects data from unauthorized disclosure/modification, but also provides trust of the web server to the client</p></li><li><p>TLS should be used everywhere</p></li><li><p><strong>Diffieâ€“Hellman key exchange</strong></p></li></ul><p>Protecting Data in Transit:</p><ul><li><p>For iOS 9 and above:</p><ul><li>Enabled by default</li><li>Blocks HTTP resource load</li><li>Uses URL Loading System (NSAppTransportSecurity) which add further transport layer checks</li><li>Highly recommended to disallow turning off the strict checks</li></ul></li><li><p>For Android 9 and above:</p><ul><li>Enabled by default</li><li>Blocks HTTP resource load</li><li>Uses SSLSocketFactory to add further transport layer checks</li><li>Highly recommended to disallow turning off the strict checks</li></ul></li></ul><h3 id="signing" tabindex="-1">Signing <a class="header-anchor" href="#signing" aria-label="Permalink to â€œSigningâ€">â€‹</a></h3><p>Digital Signatures</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> createSign</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> createVerify</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> }</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> require</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">crypto</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> {</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> publicKey</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> privateKey</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;"> }</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> require</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">./keypair</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;"> // generated in Asymmetric Encryption</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> message</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">need for speed</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">// sign</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> signer</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> createSign</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">rsa-sha256</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">signer</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">update</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">message</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> signature</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> signer</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">sign</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">privateKey</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">hex</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">// verify</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> verifier</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> createVerify</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">rsa-sha256</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">verifier</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">update</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">message</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">const</span><span style="--shiki-dark:#BD976A;--shiki-light:#005CC5;"> isVerified</span><span style="--shiki-dark:#666666;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> verifier</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">verify</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">publicKey</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;"> signature</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">,</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &quot;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">hex</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&quot;</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">);</span></span></code></pre></div><h3 id="tls" tabindex="-1">TLS <a class="header-anchor" href="#tls" aria-label="Permalink to â€œTLSâ€">â€‹</a></h3><ul><li><p>Combination of symmetric and asymmetric cryptography</p></li><li><p>Provides good compromise between performance and security</p></li><li><p>Symmetric Cryptography:</p><ul><li>Secret key used to encrypt and decrypt data</li><li>Typically 128 bits in length but 256 bit is secure</li><li>Fast and efficient</li><li>Sharing the secret key is hard</li></ul></li><li><p>Asymmetric Cryptography:</p><ul><li>Public/Private key pairs that are mathematically related</li><li>Public key to encrypt data and private key to decrypt data</li><li>Requires minimum of 1024 bit key but 2048 bit is preferred</li><li>Too slow for many purposes but great for generating and exchanging session key</li></ul></li></ul><p>TLS Protocols &amp; Cipher Suites:</p><table tabindex="0"><thead><tr><th style="text-align:center;">Protocol Version</th><th style="text-align:center;">Cipher Suites</th><th style="text-align:center;">Compliance</th></tr></thead><tbody><tr><td style="text-align:center;">SSLv2</td><td style="text-align:center;">Weak</td><td style="text-align:center;">-</td></tr><tr><td style="text-align:center;">SSLv3</td><td style="text-align:center;">Weak</td><td style="text-align:center;">-</td></tr><tr><td style="text-align:center;">TLSv1.0</td><td style="text-align:center;">Weak</td><td style="text-align:center;">-</td></tr><tr><td style="text-align:center;">TLSv1.1</td><td style="text-align:center;">Moderate</td><td style="text-align:center;">!</td></tr><tr><td style="text-align:center;">TLSv1.2</td><td style="text-align:center;">Strong</td><td style="text-align:center;">yes</td></tr><tr><td style="text-align:center;">TLSv1.3</td><td style="text-align:center;">Strong</td><td style="text-align:center;">yes</td></tr></tbody></table><h4 id="digital-certificates" tabindex="-1">Digital Certificates <a class="header-anchor" href="#digital-certificates" aria-label="Permalink to â€œDigital Certificatesâ€">â€‹</a></h4><ul><li>Contains the public key of the web server</li><li>Certificate is digitally signed by the CBA <ul><li>Authenticity of the public key and that the owner controls the domain (&quot;Common Name&quot;) being secured by the certificate</li><li>Allows clients to authenticate the web server</li><li>Must be a SHA-2 certificate</li><li>CN (Common Name) is being deprecated and will be replaced by SAN (Subject Alternate Name)</li></ul></li></ul><h5 id="certification-authorities" tabindex="-1">Certification Authorities <a class="header-anchor" href="#certification-authorities" aria-label="Permalink to â€œCertification Authoritiesâ€">â€‹</a></h5><ul><li>Validates that an entity (e.g. person, company) submitting a certificate request for a web site is authorised to do so</li><li>May also validate organisation information (&quot;Extended Validation Certificates&quot;)</li><li>CA must be trusted by all participants <ul><li>Internet browsers embed public certificates of recognised certification authorities</li><li>Organisations can embed their own RootCA as a trusted certificate. Limited to internal network only</li></ul></li></ul><h5 id="public-key-infrastructure-pki" tabindex="-1">Public Key Infrastructure (PKI) <a class="header-anchor" href="#public-key-infrastructure-pki" aria-label="Permalink to â€œPublic Key Infrastructure (PKI)â€">â€‹</a></h5><ul><li>PKI is about how two entities learn to trust each other to exchange messages securely</li><li>Central idea of PKI is that some trusted keys can delegate their trust to other un-trusted keys</li><li>Instead of just keys, certificates hold more personal information like domain name, organization, etc...</li><li>Primarily made up of: <ul><li>Certificate Authority (CA): An entity that issues digital certificates to websites</li><li>Registration Authority</li><li>Certificate Databases</li><li>Certificate Stores</li><li>Key Archival Servers</li></ul></li></ul><h3 id="breaking-tls" tabindex="-1">Breaking TLS <a class="header-anchor" href="#breaking-tls" aria-label="Permalink to â€œBreaking TLSâ€">â€‹</a></h3><ul><li>Working with rooted devices</li><li>Trusting any CA certificates (system or custom)</li><li>Accepting self-signed certificates</li><li>Setting permissive hostname verifier</li></ul><h2 id="http-strict-transport-security-hsts" tabindex="-1">HTTP Strict Transport Security (HSTS) <a class="header-anchor" href="#http-strict-transport-security-hsts" aria-label="Permalink to â€œHTTP Strict Transport Security (HSTS)â€">â€‹</a></h2><ul><li><p>It is a HTTP header</p></li><li><p>Ensures all communication are through HTTPS</p></li><li><p>Automatically redirects HTTP request to HTTPS (HTTP 307)</p></li><li><p>HSTS dose not allow a user to override the invalid certificate message</p></li><li><p><strong>Warning</strong>: Once implemented cannot go back to HTTP without breaking application</p></li><li><p>HSTS Directives:</p><ul><li><code>max-age</code>: Time in seconds for browser to remember HSTS</li><li><code>includeSubDomains</code>: HSTS rule applies to all of the site&#39;s subdomains</li><li><code>preload</code>: <ul><li><p>Good:</p><ul><li>Google maintained list</li><li>Currently supported by all major browsers</li><li>Defends against first-time SSL strip attacks</li></ul></li><li><p>Bad:</p><ul><li>Not an official HSTS spec</li><li>Sending preload directive can have permanent consequences</li><li>Preload can only be used with adding all subdomains</li></ul></li></ul></li></ul><div class="language-http"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#22863A;">Strict-Transport-Security</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> max-age=3153600; includeSubDomains; preload</span></span></code></pre></div></li></ul><h2 id="best-practices" tabindex="-1">Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to â€œBest Practicesâ€">â€‹</a></h2><ul><li>Never design your own encryption algorithm</li><li>Use established, public algorithms that have been tested by experts (e.g. AES, RSA, SHA256+)</li></ul><table tabindex="0"><thead><tr><th>Attribute</th><th style="text-align:center;">Encryption</th><th style="text-align:center;">Hashing</th><th style="text-align:center;">Encoding</th></tr></thead><tbody><tr><td>Decode</td><td style="text-align:center;">yes</td><td style="text-align:center;">-</td><td style="text-align:center;">yes</td></tr><tr><td>Secret/Key Needed</td><td style="text-align:center;">yes</td><td style="text-align:center;">!</td><td style="text-align:center;">-</td></tr><tr><td>Password Storage</td><td style="text-align:center;">-</td><td style="text-align:center;">yes</td><td style="text-align:center;">-</td></tr><tr><td>Data Storage in DB/FS</td><td style="text-align:center;">yes</td><td style="text-align:center;">-</td><td style="text-align:center;">-</td></tr><tr><td>Web Tokens</td><td style="text-align:center;">-</td><td style="text-align:center;">-</td><td style="text-align:center;">yes</td></tr></tbody></table><p>Recommended Cryptographic Algorithms:</p><table tabindex="0"><thead><tr><th>Service</th><th style="text-align:center;">Approved</th><th style="text-align:center;">Not Approved</th></tr></thead><tbody><tr><td>Data Confidentiality (e.g. DBs, Hard Disks, Flat files, ...)</td><td style="text-align:center;">AES(256+)</td><td style="text-align:center;">DES, 2DES, Blowfish</td></tr><tr><td>Data Integrity</td><td style="text-align:center;">HMAC(128+), SHA(256+)</td><td style="text-align:center;">MD5, SHA1</td></tr></tbody></table><ul><li>Use Argon2bi, bycrpt or sycrpt</li><li><strong>Strong configuration is required</strong></li></ul><table tabindex="0"><thead><tr><th>AES Modes</th><th>Confidentiality</th><th>Integrity</th><th>Authenticity</th></tr></thead><tbody><tr><td>AES-CTR</td><td>Yes</td><td>-</td><td>-</td></tr><tr><td>AES-CBC</td><td>Yes</td><td>-</td><td>-</td></tr><tr><td>AES-GCM (recommended)</td><td>Yes</td><td>Yes</td><td>Yes</td></tr></tbody></table><h2 id="pinning-certificate-transparency" tabindex="-1">Pinning &amp; Certificate Transparency <a class="header-anchor" href="#pinning-certificate-transparency" aria-label="Permalink to â€œPinning &amp; Certificate Transparencyâ€">â€‹</a></h2><blockquote><p>&quot;You should pin anytime you want to be relatively certain of the remote host&#39;s identity or when operating in a hostile environment. Since one or both are almost always true, you should probably pin all the time&quot;</p><ul><li>OWASP</li></ul></blockquote><p>What to pin?</p><ul><li>Certificate</li><li>Public Key</li><li>Hash</li></ul><p>Where to pin?</p><ul><li>Leaf certificate</li><li>Root certificate</li><li>Intermediate certificate</li></ul><p>Mobile Apps:</p><ul><li>Pin against the public key, or more specifically the SubjectPublicKeyInfo (SPKI)</li><li>key storage: Preloading, Trust on first use, <strong>Over the air pin server</strong></li><li>If bricked, app update can be pushed</li></ul><p>Web Apps:</p><ul><li>Pinning happens with HPKP header (deprecated)</li><li>Need second key pinned that&#39;s not in current certificate chain. E.g. Backup CSR</li><li>If blocked or compromised, the app is blocked for users till max-age expires or user deletes pinning</li><li>Pinning carries very strong risks of blocking or bricking applications</li><li>Hard to build a pin-set that&#39;s guaranteed to work and the risk of hostile pinning</li><li>Very low adoption rate</li></ul><h3 id="certificate-transparency" tabindex="-1">Certificate Transparency <a class="header-anchor" href="#certificate-transparency" aria-label="Permalink to â€œCertificate Transparencyâ€">â€‹</a></h3><p>How do I trust a CA?</p><ul><li><p>All CAs must submit certificate activity logs to CT Log services</p></li><li><p>CTLogs must be monitored and audited by organisation</p></li><li><p><em>A Signed Certificate Timestamp</em> (SCT) is generated and returned when a certificate is submitted</p></li><li><p>All newly issued certificates must contain SCT and all CAs in Chrome&#39;s trusted store should have CT Logs</p></li><li><p>Web Server can enforce browsers to check and validate SCT using <code>Expect-CT</code> header</p><div class="language-http"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#22863A;">Except-CT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> max-age=86400, enforce, report-uri=&quot;https://example.com/report&quot;</span></span></code></pre></div></li><li><p>Chrome (Full support), Firefox (Implemented but disabled), Safari (Upcoming)</p></li></ul><h2 id="encryption-techniques" tabindex="-1">Encryption Techniques <a class="header-anchor" href="#encryption-techniques" aria-label="Permalink to â€œEncryption Techniquesâ€">â€‹</a></h2><ul><li>Caesar cipher</li></ul><h2 id="acronyms" tabindex="-1">Acronyms <a class="header-anchor" href="#acronyms" aria-label="Permalink to â€œAcronymsâ€">â€‹</a></h2><ul><li>SHA256 (Secure Hash Algorithm 2)</li><li>RSA (Rivestâ€“Shamirâ€“Adleman)</li><li>PEM (Privacy Enhanced Mail)</li></ul><h2 id="references" tabindex="-1">References <a class="header-anchor" href="#references" aria-label="Permalink to â€œReferencesâ€">â€‹</a></h2><ul><li><p><em>The Code Book: The Science of Secrecy from Ancient Egypt to Quantum Cryptography</em> by Simon Singh (ISBN-10: 0-385-495323) (1999) (Introductory)</p></li><li><p><em>Cryptography Engineering: Design Principles and Practical Applications</em> by Niels Ferguson, Tadayoshi Kohno, Bruce Schneier (ISBN-13: 978-0-470-47424-2) (2010)</p></li><li><p><em>Serious Cryptography: A Practical Introduction to Modern Encryption</em> by Jean-Philippe Aumasson (ISBN-13: 978-1593278267) (2017)</p></li><li><p><a href="https://www.php.net/manual/en/book.password.php" target="_blank" rel="noreferrer">Password Hashing in PHP</a></p></li><li><p><a href="https://paragonie.com/book/pecl-libsodium" target="_blank" rel="noreferrer">Using Libsodium in PHP Projects</a></p></li><li><p><a href="https://www.php.net/manual/en/book.openssl.php" target="_blank" rel="noreferrer">OpenSSL in PHP</a></p></li><li><p>Cryptographically Secure Pseudorandom Number Generator (CSPRNG) Or Cryptographic Pseudorandom Number Generator (CPRNG)</p></li></ul>`,86)]])}var s=r(a,[[`render`,o]]);export{i as __pageData,s as default};