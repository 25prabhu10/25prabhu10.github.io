import{f as e,h as t,j as n,t as r}from"./chunks/plugin-vue_export-helper.Dz-VHcSB.js";const i=JSON.parse(`{"title":"PostgreSQL","description":"PostgreSQL is a free and open-source relational database management system","frontmatter":{"title":"PostgreSQL","description":"PostgreSQL is a free and open-source relational database management system"},"headers":[],"relativePath":"Concepts/Databases/PostgreSQL.md","filePath":"Concepts/Databases/PostgreSQL.md","lastUpdated":1767053997000}`);var a={name:`Concepts/Databases/PostgreSQL.md`};function o(r,i,a,o,s,c){return n(),e(`div`,null,[...i[0]||=[t(`<h1 id="postgresql" tabindex="-1">PostgreSQL <a class="header-anchor" href="#postgresql" aria-label="Permalink to “PostgreSQL”">​</a></h1><p><a href="https://www.postgresql.org/" target="_blank" rel="noreferrer">PostgreSQL</a> or also known as Postgres, is a free and open-source relational database management system. PostgreSQL features transactions with <a href="./Database.html#acid-properties"><strong>Atomicity</strong>, <strong>Consistency</strong>, <strong>Isolation</strong>, <strong>Durability</strong> (<em>ACID</em>) properties</a> automatically updatable views, materialized views, triggers, foreign keys, and stored procedures. It is designed to handle a range of workloads, from single machines to data warehouses or web services with many concurrent users</p><p>Features:</p><ul><li>ACID Compliance</li><li>SQL Compliance</li><li>OLTP (Online Transaction Processing)</li><li>MVCC (Multi-Version Concurrency Control)</li><li>Extensible</li><li>Advanced Data Types (JSON, XML, Arrays, Key-Value Pairs, Geometric types, etc.)</li></ul><h2 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to “Installation”">​</a></h2><p>PostgreSQL can be installed on various <a href="https://www.postgresql.org/download/" target="_blank" rel="noreferrer">operating systems</a> using different methods such as package managers, source code compilation, or containerization</p><p><em>Example:</em> Install PostgreSQL on Ubuntu/Debian</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">sudo</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> apt</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> update</span></span>
<span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">sudo</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> apt</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> install</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -y</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> postgresql</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> postgresql-contrib</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> postgresql-client</span></span>
<span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">sudo</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> systemctl</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> status</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> postgresql.service</span></span></code></pre></div><ul><li><a href="https://wiki.archlinux.org/title/PostgreSQL" target="_blank" rel="noreferrer">PostgreSQL on Arch Linux</a></li></ul><h3 id="install-deploy-postgres-on-kubernetes-with-zalando-postgres-operator" tabindex="-1">Install/deploy Postgres on Kubernetes with Zalando Postgres Operator <a class="header-anchor" href="#install-deploy-postgres-on-kubernetes-with-zalando-postgres-operator" aria-label="Permalink to “Install/deploy Postgres on Kubernetes with Zalando Postgres Operator”">​</a></h3><p>Postgres can be containerized and deployed on Kubernetes clusters as well. There are several tools called <em>Kubernetes Operators</em> which handle the deployment of Postgres clusters for you. One of it is the <a href="https://github.com/zalando/postgres-operator" target="_blank" rel="noreferrer">Postgres Operator by Zalando</a></p><p>You can find some tutorials regarding deployment of the operator and how to work with it, in the link list below:</p><ul><li><p><a href="https://thedatabaseme.de/2022/03/13/keep-the-elefants-in-line-deploy-zalando-operator-on-your-kubernetes-cluster/" target="_blank" rel="noreferrer">Deploy Zalando Postgres Operator on your Kubernetes cluster</a></p></li><li><p><a href="https://thedatabaseme.de/2022/03/26/backup-to-s3-configure-zalando-postgres-operator-backup-with-wal-g/" target="_blank" rel="noreferrer">Configure Zalando Postgres Operator Backup with WAL-G</a></p></li><li><p><a href="https://thedatabaseme.de/2022/05/03/restore-and-clone-from-s3-configure-zalando-postgres-operator-restore-with-wal-g/" target="_blank" rel="noreferrer">Configure Zalando Postgres Operator Restore with WAL-G</a></p></li></ul><h2 id="connect-to-postgres-instance" tabindex="-1">Connect to Postgres instance <a class="header-anchor" href="#connect-to-postgres-instance" aria-label="Permalink to “Connect to Postgres instance”">​</a></h2><p>To connect to a Postgres instance, you can use the <code>psql</code> command-line tool. By default, Postgres creates a database user called <code>postgres</code> which has superuser privileges. You can switch to the <code>postgres</code> OS user and connect to the Postgres instance by the following command:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">sudo</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -u</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> postgres</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> psql</span></span></code></pre></div><p>This will connect you to the Postgres instance and open a <code>psql</code> prompt:</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span>postgres=#</span></span></code></pre></div><p>We can use GUI tools as well to connect to Postgres instances, e.g. <a href="https://www.pgadmin.org/" target="_blank" rel="noreferrer">pgAdmin</a>, <a href="https://dbeaver.io/" target="_blank" rel="noreferrer">DBeaver</a>, <a href="https://www.jetbrains.com/datagrip/" target="_blank" rel="noreferrer">DataGrip</a>, <a href="https://github.com/beekeeper-studio/beekeeper-studio" target="_blank" rel="noreferrer">beekeeper-studio</a> etc...</p><h2 id="user-configuration-and-authentication" tabindex="-1">User configuration and authentication <a class="header-anchor" href="#user-configuration-and-authentication" aria-label="Permalink to “User configuration and authentication”">​</a></h2><p>The password for the <code>postgres</code> database user can be set the quick command <code>\\password</code> or by <code>alter user postgres password &#39;SuperSecretPassword&#39;</code>. A connection using the <code>postgres</code> user is still not possible from the &quot;outside&quot; hence to the default settings in the <code>pg_hba.conf</code></p><p>Update <code>pg_hba.conf</code> to allow postgres user connections with password</p><ul><li>In order to allow connections of the <code>postgres</code> database user not using OS user authentication, you have to update the <code>pg_hba.conf</code> which can be found under <code>/var/lib/postgres/data/pg_hba.conf</code></li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">sudo</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> vi</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> /etc/postgresql/version/main/pg_hba.conf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#B8A965;--shiki-light:#005CC5;">..</span></span>
<span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">local</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">   all</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">             postgres</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">                                peer</span></span>
<span class="line"><span style="--shiki-dark:#B8A965;--shiki-light:#005CC5;">..</span></span></code></pre></div><p>Change the last section of the above line to <code>md5</code>:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">local</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">   all</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">             postgres</span><span style="--shiki-dark:#BD976A;--shiki-light:#24292E;">                                md5</span></span></code></pre></div><p>A restart is required in order to apply the new configuration:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">sudo</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> systemctl</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> restart</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> postgresql</span></span></code></pre></div><p>Now a connection from outside the database host is possible e.g</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">psql</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -U</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> postgres</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -d</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> postgres</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -h</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> databasehostname</span></span></code></pre></div><h3 id="user-creation" tabindex="-1">User creation <a class="header-anchor" href="#user-creation" aria-label="Permalink to “User creation”">​</a></h3><p>A database user can be created by the following command:</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> USER</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> myuser</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> WITH</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> encrypted</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> password</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">Supersecret</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">postgres</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"># \\du</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">                                   List of roles</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> Role</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> name</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> |                         Attributes                         | Member of</span></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-----------+------------------------------------------------------------+-----------</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> myuser    |                                                            | {}</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> postgres  | Superuser, </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">Create</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> role</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">Create</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> DB, Replication, Bypass RLS | {}</span></span></code></pre></div><ul><li>Or use <code>createuser</code> command from the shell:</li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">createuser</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> --interactive</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> myuser</span></span></code></pre></div><h2 id="create-a-new-database" tabindex="-1">Create a new database <a class="header-anchor" href="#create-a-new-database" aria-label="Permalink to “Create a new database”">​</a></h2><p>One can create new Postgres databases within an instance. Therefore you can use the <code>psql</code> command to login (see above)</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> DATABASE</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> dbname</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> OWNER</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> myuser;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">postgres</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"># \\l</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">                                  List of databases</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">   Name</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    |  </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">Owner</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">   | </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">Encoding</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> |   </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">Collate</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">   |    Ctype    |   Access privileges</span></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-----------+----------+----------+-------------+-------------+-----------------------</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> dbname    | myuser   | UTF8     | </span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">en_US</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">UTF</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">-</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">8</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> | </span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">en_US</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">UTF</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">-</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">8</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> |</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> postgres  | postgres | UTF8     | </span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">en_US</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">UTF</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">-</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">8</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> | </span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">en_US</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">UTF</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">-</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">8</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> |</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> template0 | postgres | UTF8     | </span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">en_US</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">UTF</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">-</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">8</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> | </span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">en_US</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">UTF</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">-</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">8</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> | </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">c</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">/</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">postgres          </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">+</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">           |          |          |             |             | postgres</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">CTc</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">/</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">postgres</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> template1 | postgres | UTF8     | </span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">en_US</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">UTF</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">-</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">8</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> | </span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">en_US</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">UTF</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">-</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">8</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> | </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">c</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">/</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">postgres          </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">+</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">           |          |          |             |             | postgres</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">CTc</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">/</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">postgres</span></span></code></pre></div><p>You can omit the <code>OWNER</code> section of the command, when doing so, the current user will become owner of the newly created database</p><p>To change the owner of an existing database later, you can use the following command:</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">postgres</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"># </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">alter</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> database</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> dbname </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">owner</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> to</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> myuser;</span></span></code></pre></div><h2 id="tables" tabindex="-1">Tables <a class="header-anchor" href="#tables" aria-label="Permalink to “Tables”">​</a></h2><p>Tables are the basic building blocks of a PostgreSQL database. They are used to store data in a structured format. PostgreSQL supports several types of tables, including:</p><ol><li>Regular tables</li><li>Temporary tables</li><li>UNLOGGED tables</li></ol><p>Show summary information about all tables in the current database:</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span>\\dt</span></span></code></pre></div><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- regular tables</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> table_schema,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">       table_name,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">       table_type</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">FROM</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> information_schema</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">tables</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">WHERE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> table_type </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">BASE TABLE</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">  AND</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> table_schema </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">NOT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> IN</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">pg_catalog</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">information_schema</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- size of a table</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> pg_size_pretty(pg_total_relation_size(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">your_table_name</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">)) </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">AS</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> total_size;</span></span></code></pre></div><p>PostgreSQL stores table data in a row-oriented format by default. However, it also supports columnar storage through extensions like <code>cstore_fdw</code> and <code>timescaledb</code></p><ul><li>Pages are the basic unit of data storage in PostgreSQL. Each page is typically 8KB in size and contains multiple rows of data</li><li>Indexes are stored separately from the table data using b-trees, hash indexes, GIN, GiST, and other index types</li></ul><p>PostgreSQL also supports table inheritance, which allows you to create a new table that inherits the structure and data of an existing table</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> parent_table</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    id </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">SERIAL</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> PRIMARY KEY</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">    name</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> TEXT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT NULL</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> child_table</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    age </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">INT</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">) INHERITS (parent_table);</span></span></code></pre></div><p>PostgreSQL also supports partitioned tables, which allow you to divide a large table into smaller, more manageable pieces called partitions</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> measurement</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    logdate </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">DATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT NULL</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    peaktemp </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">INT</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    unitsales </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">INT</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">PARTITION</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> BY</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> RANGE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (logdate);</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> measurement_y2020</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> PARTITION</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> OF measurement</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">    FOR</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> VALUES</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> FROM</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">2020-01-01</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">TO</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">2021-01-01</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> measurement_y2021</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> PARTITION</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> OF measurement</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">    FOR</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> VALUES</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> FROM</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">2021-01-01</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">TO</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">2022-01-01</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span></code></pre></div><h3 id="unlogged-tables" tabindex="-1">UNLOGGED tables <a class="header-anchor" href="#unlogged-tables" aria-label="Permalink to “UNLOGGED tables”">​</a></h3><p><code>UNLOGGED</code> tables are not written to the WAL (Write-Ahead Log) and are not replicated to the standby servers. They are faster than regular tables because they do not have to be written to the WAL. They are useful for temporary tables that do not need to be replicated</p><ul><li>It can be used as a in-memory table for temporary data like a cache</li></ul><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> UNLOGGED </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">TABLE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> cache_table (</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">    key</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> TEXT</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> PRIMARY KEY</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">    value</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> TEXT</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    expires_at </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">TIMESTAMP</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT NULL</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> WITH</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> TIME</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> ZONE</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">INSERT INTO</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> cache_table (</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">key</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">value</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, expires_at)</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">VALUES</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">session_123</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">user_data</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">NOW</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">()</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> +</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> INTERVAL </span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">1 hour</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> *</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> FROM</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> cache_table</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">WHERE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> key</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">session_123</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> AND</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> expires_at </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">&gt;</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOW</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">()</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span></code></pre></div><p>To use <code>UNLOGGED</code> tables, you need to have the <code>unlogged_table</code> parameter set to <code>on</code> in the <code>postgresql.conf</code> file</p><div class="language-text"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span>unlogged_table = on</span></span></code></pre></div><ul><li>Set <code>shared_buffers</code> to at least 25% of RAM</li><li>Use <em>auto vacuum</em> to clean up dead tuples</li><li>Also, you can create cron jobs to clean up the table</li></ul><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> cron</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">schedule</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(</span></span>
<span class="line"><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">  &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">clean_cache_table</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">  &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">0 0 * * *</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">  $$</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">DELETE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> FROM</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> cache_table </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">WHERE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> expires_at </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">&lt;=</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOW</span><span style="--shiki-dark:#666666;--shiki-light:#24292E;">()</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;$$</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span></code></pre></div><h2 id="data-types" tabindex="-1">Data Types <a class="header-anchor" href="#data-types" aria-label="Permalink to “Data Types”">​</a></h2><p>PostgreSQL supports a wide range of data types. The following list shows some of the most common data types:</p><ul><li><code>integer</code></li></ul><h3 id="text" tabindex="-1">Text <a class="header-anchor" href="#text" aria-label="Permalink to “Text”">​</a></h3><h4 id="search-vector" tabindex="-1">Search Vector <a class="header-anchor" href="#search-vector" aria-label="Permalink to “Search Vector”">​</a></h4><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> blogs</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    id </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">SERIAL</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> PRIMARY KEY</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    title </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">TEXT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT NULL</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    content </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">TEXT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT NULL</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    search_vector TSVECTOR</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> INDEX</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> search_vector_idx</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> ON</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> blogs </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">USING</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> GIN(search_vectorarch);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">INSERT INTO</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> blogs (title, content) </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">VALUES</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">Postgres Full-Text Search</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">Postgres is a powerful open-source database.</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">),</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">Postgres JSONB</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">Postgres supports JSONB data type.</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> title,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">       ts_rank(search_vector, plainto_tsquery(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">open-source</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">)) </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">AS</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> rank</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">FROM</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> blogs,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">     to_tsquery(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">english</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">open-source</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">AS</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> query</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">WHERE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> search_vector @@ query</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">ORDER BY</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> rank </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">DESC</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span></code></pre></div><h3 id="json" tabindex="-1">JSON <a class="header-anchor" href="#json" aria-label="Permalink to “JSON”">​</a></h3><p>PostgreSQL supports JSON data type. JSON is stored as binary JSON (JSONB) which is a decomposed binary format</p><p>The following example shows how to create a table with a JSON column:</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> json_table</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    id </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">serial</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> PRIMARY KEY</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">    data</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> json</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT NULL</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span></code></pre></div><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- create a table with a JSONB column</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> horses</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    id </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">serial</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> PRIMARY KEY</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">    name</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> TEXT</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    attributes JSONB</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- insert a JSON object</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">INSERT INTO</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> horses (</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">name</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, attributes)</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">VALUES</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">Horse1</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">{&quot;color&quot;: &quot;brown&quot;, &quot;age&quot;: 5, &quot;weight&quot;: 500}</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- query the JSON object</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> *</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> FROM</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> horses</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">WHERE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> attributes</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">-&gt;&gt;</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">color</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">brown</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span></code></pre></div><h2 id="indexes" tabindex="-1">Indexes <a class="header-anchor" href="#indexes" aria-label="Permalink to “Indexes”">​</a></h2><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> INDEX</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> idx_column_name</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> ON</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> your_table_name (column_name);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- partial index</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> INDEX</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> idx_active_users</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> ON</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> your_table_name (user_id) </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">WHERE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> active </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> true;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- use hash index</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> INDEX</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> idx_column_name_hash</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> ON</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> your_table_name </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">USING</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> HASH</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (column_name);</span></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- use GIN index for JSONB column</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> INDEX</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> idx_jsonb_column</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> ON</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> your_table_name </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">USING</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> GIN (jsonb_column);</span></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- full-text search index</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> INDEX</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> idx_fulltext</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> ON</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> your_table_name </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">USING</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> GIN (to_tsvector(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">english</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, text_column));</span></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- use GiST index for geometric data types</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> INDEX</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> idx_geom_column</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> ON</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> your_table_name </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">USING</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> GiST (geom_column);</span></span></code></pre></div><table tabindex="0"><thead><tr><th>Index Type</th><th>Description</th><th>Use Case</th></tr></thead><tbody><tr><td>B-tree</td><td>Default index type, supports equality and range queries</td><td>General-purpose indexing</td></tr><tr><td>Hash</td><td>Supports equality queries only</td><td>When only equality comparisons are needed</td></tr><tr><td>GIN</td><td>Supports full-text search and array indexing</td><td>Full-text search, JSONB indexing</td></tr><tr><td>GiST</td><td>Supports geometric data types and full-text search</td><td>Geometric data, full-text search</td></tr><tr><td>SP-GiST</td><td>Supports partitioned data structures</td><td>Spatial data, hierarchical data</td></tr><tr><td>BRIN</td><td>Block Range INdexes for large tables with natural ordering</td><td>Very large tables where data is naturally ordered</td></tr></tbody></table><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- show index sizes of a table</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> pg_stat_user_indexes</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">indexrelname</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, pg_size_pretty(pg_relation_size(indexrelid)) </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">AS</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> index_size </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">FROM</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> pg_stat_user_indexes </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">join</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> pg_index </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">using</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (indexrelid) </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">WHERE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> relname </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">your_table_name</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- query index usage statistics</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> indexrelname, idx_scan, idx_tup_read, idx_tup_fetch</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">FROM</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> pg_stat_user_indexes</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">WHERE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> relname </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">your_table_name</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- list all indexes on a table</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> i</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">indexname</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">i</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">tablename</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">c</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">relname</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> AS</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> index_relname, </span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">am</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">amname</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> AS</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> index_type</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">FROM</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> pg_indexes i</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">JOIN</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> pg_class c </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">ON</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> c</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">relname</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> i</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">indexname</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">JOIN</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> pg_index pi </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">ON</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> pi</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">indexrelid</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> c</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">oid</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">JOIN</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> pg_am am </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">ON</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> am</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">oid</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> c</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">relam</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">WHERE</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> i</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">tablename</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">your_table_name</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span></code></pre></div><h2 id="architecture" tabindex="-1">Architecture <a class="header-anchor" href="#architecture" aria-label="Permalink to “Architecture”">​</a></h2><p>PostgreSQL follows a client-server architecture. The main components of PostgreSQL architecture are:</p><ol><li><p><strong>Postmaster</strong>: The main server process that manages database connections and starts other processes</p></li><li><p><strong>Background Processes</strong>: Various processes that handle tasks like writing to disk, cleaning up dead tuples, and managing replication. One process per active connection: <code>postgres</code> process</p><ul><li><strong>Background Writer Process</strong>: Writes dirty pages from shared memory to disk</li><li><strong>Autovacuum Process</strong>: Cleans up dead tuples and updates statistics</li><li><strong>WAL Writer Process</strong>: Writes WAL records to disk</li><li><strong>Checkpointer Process</strong>: Periodically writes all dirty pages to disk to ensure data durability</li><li><strong>Archiver Process</strong>: Archives completed WAL segments for backup and recovery</li></ul></li><li><p><strong>Shared Memory</strong>: A memory area that is shared among all PostgreSQL processes for caching data and coordinating access to the database</p><ul><li><strong>Shared Buffers</strong>: A portion of shared memory used to cache data pages</li><li><strong>WAL Buffers</strong>: A portion of shared memory used to cache WAL records</li></ul></li><li><p><strong>WAL (Write-Ahead Log)</strong>: A log that records all changes made to the database for durability and crash recovery</p></li><li><p><strong>Disk Storage</strong>: The physical storage where database files, tables, indexes, and WAL files are stored</p><ul><li><strong>Data Clusters</strong>: A collection of databases managed by a single PostgreSQL server instance</li><li><strong>Data Files</strong>: Store the actual data for tables and indexes</li><li><strong>WAL Files</strong>: Store the write-ahead log records</li></ul></li></ol><h3 id="data-storage" tabindex="-1">Data Storage <a class="header-anchor" href="#data-storage" aria-label="Permalink to “Data Storage”">​</a></h3><p>PostgreSQL stores data in a structured format using tables, which are organized into databases. Each database is stored in a separate directory on disk. The data for each table is stored in one or more files, depending on the size of the table</p><ul><li>A table is made up of multiple pages, and each page contains multiple rows of data</li><li>PostgreSQL uses a heap storage model, where rows are stored in no particular order. This allows for efficient insertion and deletion of rows</li><li>A heap is a collection of a fixed size pages, where each page is typically <code>8KB</code> in size</li><li>Each row has a unique identifier called a TID (Tuple Identifier) that is used to locate the row on disk</li><li>Indexes are stored separately from the table data, allowing for efficient querying and retrieval of data</li></ul><h4 id="toast-the-oversized-attribute-storage-technique" tabindex="-1">TOAST - The Oversized-Attribute Storage Technique <a class="header-anchor" href="#toast-the-oversized-attribute-storage-technique" aria-label="Permalink to “TOAST - The Oversized-Attribute Storage Technique”">​</a></h4><p>PostgreSQL uses TOAST to handle large data types that exceed the size of a single page (8KB by default). TOAST automatically compresses and stores large values in a separate table, allowing for efficient storage and retrieval of large data types</p><ul><li>When a large value is inserted into a table, PostgreSQL checks if the value exceeds the page size</li><li>If the value exceeds the page size, PostgreSQL compresses the value and stores it in a separate TOAST table</li><li>The original table stores a reference to the TOAST table, allowing for efficient retrieval of the large value when needed</li></ul><p>By default, <code>pglz</code> compression is used for TOASTed values, but other compression methods can be configured as well, e.g., <code>lz4</code>, <code>zstd</code></p><h3 id="query-processing" tabindex="-1">Query Processing <a class="header-anchor" href="#query-processing" aria-label="Permalink to “Query Processing”">​</a></h3><p>Steps in query processing:</p><ol><li><strong>Client Connection</strong>: A client connects to the PostgreSQL server using a client library (e.g., libpq)</li><li><strong>Query Parsing</strong>: The server parses the SQL query to check for syntax errors</li><li><strong>Query Planning</strong>: The server generates a query plan based on the parsed query and the database schema</li><li><strong>Query Execution</strong>: The server executes the query plan and retrieves the requested data</li><li><strong>Result Return</strong>: The server sends the query results back to the client</li></ol><h3 id="transactions" tabindex="-1">Transactions <a class="header-anchor" href="#transactions" aria-label="Permalink to “Transactions”">​</a></h3><p>PostgreSQL supports transactions, which allow multiple SQL statements to be executed as a single unit of work. Transactions ensure that either all statements are executed successfully, or none of them are executed at all</p><ul><li>Transactions are started with the <code>BEGIN</code> command and ended with either <code>COMMIT</code> or <code>ROLLBACK</code></li></ul><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">BEGIN</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">UPDATE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> accounts </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SET</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> balance </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> balance </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">-</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;"> 100</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> WHERE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> account_id </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;"> 1</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">UPDATE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> accounts </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SET</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> balance </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> balance </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">+</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;"> 100</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> WHERE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> account_id </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;"> 2</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">COMMIT</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span></code></pre></div><h3 id="multi-version-concurrency-control-mvcc" tabindex="-1">Multi-Version Concurrency Control (MVCC) <a class="header-anchor" href="#multi-version-concurrency-control-mvcc" aria-label="Permalink to “Multi-Version Concurrency Control (MVCC)”">​</a></h3><p>PostgreSQL uses MVCC to handle concurrent access to the database. MVCC allows multiple transactions to access the same data simultaneously without blocking each other</p><ul><li>Each transaction sees a snapshot of the database at the time it started</li><li>When a transaction modifies data, it creates a new version of the data rather than overwriting the existing data</li><li>Other transactions continue to see the old version of the data until they commit</li></ul><h2 id="plpgsql-procedural-language" tabindex="-1"><code>plpgsql</code> - Procedural Language <a class="header-anchor" href="#plpgsql-procedural-language" aria-label="Permalink to “plpgsql - Procedural Language”">​</a></h2><p><code>plpgsql</code> is a procedural language for PostgreSQL that allows you to write functions and stored procedures using SQL and control structures like loops and conditionals. It is similar to other procedural languages like PL/SQL in Oracle and T-SQL in SQL Server</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE OR REPLACE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> FUNCTION</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> calculate_discount</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(price </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">NUMERIC</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, discount_rate </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">NUMERIC</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">)</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">RETURNS</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> NUMERIC</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> AS</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> $$</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">BEGIN</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">    RETURN</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> price </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">-</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (price </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">*</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> discount_rate </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">/</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;"> 100</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">END</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">$$ </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">LANGUAGE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> plpgsql;</span></span></code></pre></div><h2 id="backup-and-restore" tabindex="-1">Backup and Restore <a class="header-anchor" href="#backup-and-restore" aria-label="Permalink to “Backup and Restore”">​</a></h2><p>There are near to endless combinations in tools and parameters to backup postgres databases. Below you can find some examples using the Postgres built-in tools <code>pgdump</code>, <code>pg_basebackup</code> and <code>pg_restore</code></p><h3 id="pg-dump-pg-dumpall" tabindex="-1"><code>pg_dump</code>/<code>pg_dumpall</code> <a class="header-anchor" href="#pg-dump-pg-dumpall" aria-label="Permalink to “pg_dump/pg_dumpall”">​</a></h3><p>Using <code>pg_dump</code> or <code>pg_dumpall</code> enables you to extract / export a PostgreSQL database(s) into a (SQL) script file or a custom archive file</p><h4 id="pg-dump" tabindex="-1"><code>pg_dump</code> <a class="header-anchor" href="#pg-dump" aria-label="Permalink to “pg_dump”">​</a></h4><p>The following command creates a custom archive file from a database specified with <code>-d</code>. Using the <code>--create</code> option will include the SQL commands in the dump script that will create the database before importing it later. The <code>-Z 9</code> option in this example compresses the SQL script created with the highest available compression rate (<code>0-9</code>)</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">pg_dump</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -h</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> vmdocker</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -U</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> awx</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -d</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> awx</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> --create</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -f</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -Z</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;"> 9</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> /tmp/awx_dump.sql.gz</span></span></code></pre></div><p>The following command creates a custom archive file from a database specified with <code>-d</code>. To export data in custom format, you have to specify so with the <code>-F c</code> option. Custom file dumps have the benefit, that they are compressed by default</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">pg_dump</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -h</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> &lt;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">pg_hos</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">t</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">&gt;</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -U</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> &lt;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">usernam</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">e</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">&gt;</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -d</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> &lt;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">databas</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">e</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">&gt;</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -F</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> c</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -f</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> /pg_dump/dumpfile.dmp</span></span></code></pre></div><p>Custom format files can only be restored by <code>pg_restore</code> (see below). A SQL dump can be restored by using <code>psql</code></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">psql</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -d</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> newdb</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -f</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> db.sql</span></span></code></pre></div><ul><li><a href="https://www.postgresql.org/docs/current/app-pgdump.html" target="_blank" rel="noreferrer"><code>pg_dump</code> guide</a></li></ul><h4 id="pg-dumpall" tabindex="-1"><code>pg-dumpall</code> <a class="header-anchor" href="#pg-dumpall" aria-label="Permalink to “pg-dumpall”">​</a></h4><p>A full dump of all databases of a Postgres instance can be done by <code>pg_dumpall</code>. It will include also user creation information</p><p>A difference to <code>pg_dump</code>, you cannot choose for different output formats. <code>pg_dumpall</code> will always create a SQL script as output. Therefore, you don&#39;t need <code>pg_restore</code> for restoring a &quot;full&quot; dump. Only <code>psql</code> is needed (see below)</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">pg_dumpall</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -h</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> &lt;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">pg_hos</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">t</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">&gt;</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -U</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> postgres</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> &gt;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> database.out</span></span></code></pre></div><p>If you use password authentication it will ask for a password each time. It is convenient to have a <code>~/.pgpass</code> file or <code>PGPASSWORD</code> environment variable set</p><p>So importing a full dump is really easy by the following <code>psql</code> command:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">psql</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -h</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> &lt;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">pg_hos</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">t</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">&gt;</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -f</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> databaseb.out</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -U</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> postgres</span></span></code></pre></div><ul><li><a href="https://www.postgresql.org/docs/current/app-pg-dumpall.html" target="_blank" rel="noreferrer"><code>pg_dumpall</code> guide</a></li></ul><h3 id="pg-restore" tabindex="-1"><code>pg-restore</code> <a class="header-anchor" href="#pg-restore" aria-label="Permalink to “pg-restore”">​</a></h3><p><code>pg_restore</code> can be used to restore custom file dumps created by <code>pg_dump</code></p><p>The following command will create the database (which has been dumped before)</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;">pg_restore</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -h</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> &lt;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">pg_hos</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">t</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">&gt;</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -U</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> &lt;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">pg_use</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">r</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">&gt;</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -d</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> postgres</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> --create</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -F</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> c</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;"> /tmp/db.dmp</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> -v</span></span></code></pre></div><ul><li><a href="https://www.postgresql.org/docs/current/app-pgrestore.html" target="_blank" rel="noreferrer"><code>pg_restore</code> guide</a></li></ul><h2 id="extensions" tabindex="-1">Extensions <a class="header-anchor" href="#extensions" aria-label="Permalink to “Extensions”">​</a></h2><h3 id="pg-mooncake" tabindex="-1"><code>pg_mooncake</code> <a class="header-anchor" href="#pg-mooncake" aria-label="Permalink to “pg_mooncake”">​</a></h3><p><code>pg_mooncake</code> is a PostgreSQL extension that provides a set of functions for working with mooncake data types. It allows you to store and query mooncake data efficiently</p><ul><li>A simple time-series data type</li></ul><h3 id="pgcrypto" tabindex="-1"><code>pgcrypto</code> <a class="header-anchor" href="#pgcrypto" aria-label="Permalink to “pgcrypto”">​</a></h3><p><code>pgcrypto</code> is a PostgreSQL extension that provides cryptographic functions. It allows you to encrypt data, generate hashes, and perform other cryptographic operations</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> EXTENSION </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">IF</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> EXISTS</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> pgcrypto;</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> EXTENSION </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">IF</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> EXISTS</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> pgjwt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> users</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">  id </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">SERIAL</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> PRIMARY KEY</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">  email </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">VARCHAR</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">255</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">UNIQUE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT NULL</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">  password</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> TEXT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT NULL</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">  name</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> VARCHAR</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">255</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">),</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">  created_at </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">TIMESTAMP WITH TIME ZONE</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> DEFAULT</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> CURRENT_TIMESTAMP</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">INSERT INTO</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> users (email, </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">password</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">name</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">)</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">VALUES</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span></span>
<span class="line"><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">  &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">abc@m.com</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">  crypt(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">password</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, gen_salt(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">bf</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">10</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">)),</span></span>
<span class="line"><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">  &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">Alice</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> id, email, </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">name</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">FROM</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> users</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">WHERE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> email </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">abc@m.com</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> AND</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> password</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> crypt(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">password</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">password</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> jwt_tokens</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">  id </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">SERIAL</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> PRIMARY KEY</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">  kid </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">VARCHAR</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">255</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">) </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">NOT NULL</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> UNIQUE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">  key</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> TEXT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT NULL</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">  created_at </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">TIMESTAMP WITH TIME ZONE</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> DEFAULT</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> CURRENT_TIMESTAMP</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span></span>
<span class="line"><span style="--shiki-dark:#B8A965;--shiki-light:#005CC5;">    sign</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(</span></span>
<span class="line"><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">        &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">{ &quot;sub&quot;: &quot;123&quot;, &quot;name&quot;: &quot;Alice&quot;, &quot;iat&quot;: 1630000000 }</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">        &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">secret_key</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">  );</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> *</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> FROM</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    verify(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">someToken</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">secret_key</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">ALTER</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> documents </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">ENABLE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> ROW</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> LEVEL</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> SECURITY</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> POLICY</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> user_documents_policy</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">ON</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> documents</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">FOR</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> SELECT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> USING</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (user_id </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> current_setting(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">jwt.claims.sub</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, true));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> set_config(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">jwt.claims.sub</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">123</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, true);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> *</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> FROM</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> blogs;</span></span></code></pre></div><h3 id="pg-cron" tabindex="-1"><code>pg_cron</code> <a class="header-anchor" href="#pg-cron" aria-label="Permalink to “pg_cron”">​</a></h3><p><code>pg_cron</code> is a simple cron-based job scheduler for PostgreSQL (9.5 or higher) that runs inside the database as an extension. It uses the same syntax as regular cron, but it allows you to schedule PostgreSQL commands directly from the database</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> EXTENSION </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">IF</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> EXISTS</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> pg_cron;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> cron</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">schedule</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(</span></span>
<span class="line"><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">  &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">daily_vacuum</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- name of the job</span></span>
<span class="line"><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">  &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">0 3 * * *</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- cron schedule</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">  $$VACUUM ANALYZE;$$ </span><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- SQL command</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> *</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> FROM</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> cron</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">job</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span></code></pre></div><h3 id="pgvector" tabindex="-1"><code>pgvector</code> <a class="header-anchor" href="#pgvector" aria-label="Permalink to “pgvector”">​</a></h3><p><code>pgvector</code> is a PostgreSQL extension that provides vector similarity search and indexing. It allows you to store and query high-dimensional vectors efficiently</p><ul><li>Use case: recommendation systems, image search, natural language processing</li></ul><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> EXTENSION </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">IF</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> EXISTS</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> vector</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span><span style="--shiki-dark:#80A665;--shiki-light:#6F42C1;"> products</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    id </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">SERIAL</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> PRIMARY KEY</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">    name</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> TEXT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT NULL</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    embedding </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">vector</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">768</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">)</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">INSERT INTO</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> products (</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">name</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, embedding)</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">VALUES</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">product1</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">[0.01, 0.23, -0.47, ...]</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> *</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> FROM</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> products</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">ORDER BY</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> embedding </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">&lt;-&gt;</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">[0.1, 0.2, -0.5, ...]</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">; </span><span style="--shiki-dark:#758575DD;--shiki-light:#6A737D;">-- find similar vectors</span></span></code></pre></div><h3 id="pgai" tabindex="-1"><code>pgai</code> <a class="header-anchor" href="#pgai" aria-label="Permalink to “pgai”">​</a></h3><p><code>pgai</code> is a PostgreSQL extension that provides machine learning and artificial intelligence capabilities. It allows you to train and deploy machine learning models directly in the database</p><ul><li>Use case: predictive analytics, fraud detection, recommendation systems</li></ul><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> EXTENSION </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">IF</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> EXISTS</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> ai CASCADE;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> ai</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">load_dataset</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(</span></span>
<span class="line"><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">    &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">wikimedia/wikipedia</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">    &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">20231101.en</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    table_name</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">wiki</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    batch_size</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">5</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    max_batches</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">1</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    if_table_exists</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">append</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">SELECT</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> ai</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">create_vetorizer</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(</span></span>
<span class="line"><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">    &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">wiki</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">::regclass,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    destination </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;"> &#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">wiki_embeddings</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">,</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    embedding </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> ai</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">embedding_ollama</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">all-minilm</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">384</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">),</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    chunking </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=&gt;</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> ai</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">chunking_recursive_character_text_splitter</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">text</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">)</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span></code></pre></div><h3 id="pg-graphql" tabindex="-1"><code>pg_graphql</code> <a class="header-anchor" href="#pg-graphql" aria-label="Permalink to “pg_graphql”">​</a></h3><p><code>pg_graphql</code> is a PostgreSQL extension that provides a GraphQL API for your database. It allows you to expose your database schema as a GraphQL API without writing any backend code</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-dark github-light" style="--shiki-dark:#dbd7caee;--shiki-light:#24292e;--shiki-dark-bg:#121212;--shiki-light-bg:#fff;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">graphqldb</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> CREATE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> EXTENSION </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">IF</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> NOT</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> EXISTS</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> pg_graphql;</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> EXTENSION</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">graphqldb</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> book(id </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">INT</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;"> PRIMARY KEY</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, title </span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">TEXT</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">CREATE</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> TABLE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">graphqldb</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> INSERT INTO</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> book(id, title) </span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">VALUES</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;">1</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#C98A7D;--shiki-light:#032F62;">PostgreSQL</span><span style="--shiki-dark:#C98A7D77;--shiki-light:#032F62;">&#39;</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">);</span></span>
<span class="line"><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;">INSERT</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;"> 0</span><span style="--shiki-dark:#4C9A91;--shiki-light:#005CC5;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">graphqldb</span><span style="--shiki-dark:#CB7676;--shiki-light:#D73A49;">=</span><span style="--shiki-dark:#4D9375;--shiki-light:#D73A49;"> SELECT</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;"> graphql</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">.</span><span style="--shiki-dark:#C99076;--shiki-light:#005CC5;">resolve</span><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">($$</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">query {</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">  bookCollection {</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    edges {</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">      node {</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">        id</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">      }</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">    }</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">  }</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">}</span></span>
<span class="line"><span style="--shiki-dark:#DBD7CAEE;--shiki-light:#24292E;">$$);</span></span></code></pre></div>`,145)]])}var s=r(a,[[`render`,o]]);export{i as __pageData,s as default};