import{A as e,d as t,m as n}from"./chunks/runtime-core.esm-bundler.BXAIOQQS.js";import{t as r}from"./chunks/plugin-vue_export-helper.CtN8rQnz.js";const i=JSON.parse(`{"title":"Nginx","description":"Open source web and application server","frontmatter":{"title":"Nginx","description":"Open source web and application server","date":"2023-07-29T00:00:00.000Z"},"headers":[],"relativePath":"Languages/Nginx.md","filePath":"Languages/Nginx.md","lastUpdated":1756574703000}`);var a={name:`Languages/Nginx.md`};function o(r,i,a,o,s,c){return e(),t(`div`,null,[...i[0]||=[n(`<h1 id="nginx" tabindex="-1">Nginx <a class="header-anchor" href="#nginx" aria-label="Permalink to “Nginx”">​</a></h1><p><a href="https://www.nginx.com/" target="_blank" rel="noreferrer">nginx</a> (&quot;engine x&quot;) is a free, open-source HTTP web server that can also be used as:</p><ul><li>Reverse proxy</li><li>Content cache</li><li>Load balancer</li><li>TCP/UDP proxy server</li><li>Mail proxy</li></ul><p><a href="https://unit.nginx.org/" target="_blank" rel="noreferrer">Nginx Unit Docs</a></p><h2 id="architecture" tabindex="-1">Architecture <a class="header-anchor" href="#architecture" aria-label="Permalink to “Architecture”">​</a></h2><p>nginx has one master process and several worker processes</p><ul><li><strong>Master process</strong>: Reads and evaluates <a href="#configuration">configuration</a>, maintains worker processes</li><li><strong>Worker processes</strong>: Do the actual processing of requests</li></ul><p>nginx uses an event-based model and OS-dependent mechanisms to efficiently distribute requests among worker processes</p><h2 id="setup" tabindex="-1">Setup <a class="header-anchor" href="#setup" aria-label="Permalink to “Setup”">​</a></h2><p>Start, stop, restart, reload, and check the status of the Nginx service:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> reload</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> nginx</span></span></code></pre></div><p>Using command line arguments:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">signa</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">l</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"># signal can be:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"># stop: fast shutdown</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"># quit: graceful shutdown</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"># reopen: reloading the configuration file</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"># reload: reopening the log files</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"># Example:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> start</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"># signal can also be sent using the kill command</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">kill</span><span style="--shiki-light:#005CC5;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> QUIT</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">pi</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">d</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">&gt;</span></span></code></pre></div><h2 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to “Configuration”">​</a></h2><p>The default configuration file is named <code>nginx.conf</code> and is located in the <code>/usr/local/nginx/conf</code>, <code>/etc/nginx</code>, or <code>/usr/local/etc/nginx</code> directory</p><p>nginx consists of modules that are controlled by directives specified in the configuration file</p><p>Directives are divided into simple directives and block directives</p><ul><li>A simple directive consists of the name and parameters separated by spaces and ends with a semicolon (<code>;</code>)</li><li>A block directive has the same structure as a simple directive, but instead of the semicolon, it ends with a set of additional directives enclosed in braces (<code>{}</code>)</li></ul><p>If a directive is placed outside of any block, it is considered a part of the <code>main</code> context</p><ul><li><code>#</code> (hash) is used for comments</li></ul><h3 id="serving-static-content" tabindex="-1">Serving Static Content <a class="header-anchor" href="#serving-static-content" aria-label="Permalink to “Serving Static Content”">​</a></h3><p>The <code>http</code> block is the main context and is used to configure how nginx handles HTTP requests</p><ul><li><p><code>server</code> block is used to define the settings for a virtual server (there can be multiple <code>server</code> blocks, distinguished by ports and server names)</p></li><li><p><code>location</code> block is used to define how nginx should handle requests for different URIs</p><ul><li><code>/</code> is used to match any request, <code>/path</code> is used to match requests for a specific path, and <code>~</code> is used for case-sensitive regular expression matching</li></ul></li><li><p><code>root</code> directive is used to define the root directory where nginx should look for files to serve</p><ul><li><code>/var/www/html</code> can be used as the root directory for serving static content or <code>/data/www</code> for a custom directory</li></ul></li></ul><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    server</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"> # listen on port 80</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">        location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">            root </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">/var/www/html</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">        location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> /images/ </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">            root </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">/data/www</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre></div><h3 id="proxy-server" tabindex="-1">Proxy Server <a class="header-anchor" href="#proxy-server" aria-label="Permalink to “Proxy Server”">​</a></h3><p>The <code>proxy_pass</code> directive is used to define the URL of the proxied server</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    server</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">        location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">            proxy_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">http://localhost:8080/</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">        location</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#C4704F;"> \\.(gif|jpg|png)$ </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">            root </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">/data/images</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre></div><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">user </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">www-data</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">worker_processes </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">auto</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">pid </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">/run/nginx.pid</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">events</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    worker_connections </span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;">768</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    include </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">/etc/nginx/mime.types</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    default_type </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">application/octet-stream</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    sendfile </span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    tcp_nopush </span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    tcp_nodelay </span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    keepalive_timeout </span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;">65</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    types_hash_max_size </span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    include </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">/etc/nginx/conf.d/*.conf</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    include </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">/etc/nginx/sites-enabled/*</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre></div><p>Logging and debugging:</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">error_log </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">&lt;file&gt; &lt;loglevel&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">    error_log logs/error.log</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    error_log </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">logs/debug.log </span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    error_log </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">logs/error.log </span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;">notice</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span></code></pre></div><p>Basic listening ports:</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">listen </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">&lt;port&gt; &lt;options&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">        listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;">80</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;">443</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> ssl http2</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;">443</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> http3 reuseport</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> is experimental!)</span></span></code></pre></div><p>Header modifications:</p><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">add_header </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">&lt;header&gt; &lt;values&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">        add_header Alt-svc </span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#666666;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#C98A7D;">http3</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">=&quot;:&lt;port&gt;&quot;; ma=&lt;value&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> is experimental!)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">ssl_certificate </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">/ ssl_certificate_key</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">        ssl_certificate cert.pem</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        ssl_certificate_key </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">cert.key</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">&lt;domains&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">    server_name domain1.com *.domain1.com</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">root &lt;folder&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">    root /var/www/html/domain1</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">index </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">&lt;file&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">    index index.php</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> &lt;url&gt; </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        root </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">index.html</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        index </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">index.html index.htm</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        try_files </span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">uri</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> $</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">uri</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">/ /index.php</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">is_args</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    location</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#C4704F;"> \\\\.php$ </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        fastcgi_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">127.0.0.1:9000</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        fastcgi_index </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">index.php</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        fastcgi_param </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> SCRIPT_FILENAME  /scripts</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">fastcgi_script_name</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        include </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">fastcgi_params</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    location</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> ~</span><span style="--shiki-light:#032F62;--shiki-dark:#C4704F;"> /\\\\.ht </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        deny </span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;">all</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    location</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#C4704F;"> /favicon.ico </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        log_not_found </span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;">off</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        access_log </span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;">off</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    location</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#C4704F;"> /robots.txt </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        log_not_found </span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;">off</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        access_log </span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;">off</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        allow </span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;">all</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    location</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> ~*</span><span style="--shiki-light:#032F62;--shiki-dark:#C4704F;"> .(css|gif|ico|jpeg|jpg|js|png)$ </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        expires </span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;">max</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        log_not_found </span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;">off</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre></div><h2 id="reverse-proxy" tabindex="-1">Reverse Proxy <a class="header-anchor" href="#reverse-proxy" aria-label="Permalink to “Reverse Proxy”">​</a></h2><h3 id="show-client-s-real-ip" tabindex="-1">Show Client&#39;s real IP <a class="header-anchor" href="#show-client-s-real-ip" aria-label="Permalink to “Show Client&#39;s real IP”">​</a></h3><div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">example.com</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        proxy_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">http://localhost:4000</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">        # Show clients real IP behind a proxy</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">X-Real-IP </span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">remote_addr</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">X-Forwarded-For </span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">proxy_add_x_forwarded_for</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">}</span></span></code></pre></div>`,37)]])}var s=r(a,[[`render`,o]]);export{i as __pageData,s as default};