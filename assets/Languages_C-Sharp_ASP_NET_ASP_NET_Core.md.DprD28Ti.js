import{A as e,d as t,m as n}from"./chunks/runtime-core.esm-bundler.BXAIOQQS.js";import{t as r}from"./chunks/plugin-vue_export-helper.CtN8rQnz.js";const i=JSON.parse(`{"title":"ASP.NET Core","description":"ASP.NET Core is a free and open-source web framework.","frontmatter":{"title":"ASP.NET Core","description":"ASP.NET Core is a free and open-source web framework."},"headers":[],"relativePath":"Languages/C-Sharp/ASP_NET/ASP_NET_Core.md","filePath":"Languages/C-Sharp/ASP_NET/ASP_NET_Core.md","lastUpdated":1756574703000}`);var a={name:`Languages/C-Sharp/ASP_NET/ASP_NET_Core.md`};function o(r,i,a,o,s,c){return e(),t(`div`,null,[...i[0]||=[n(`<h1 id="asp-net-core" tabindex="-1">ASP.NET Core <a class="header-anchor" href="#asp-net-core" aria-label="Permalink to “ASP.NET Core”">​</a></h1><p>ASP.NET Core (Active Server Pages) was released in 2016. It&#39;s <strong>not tied to windows</strong> assemblies like <code>System.Web</code>, <a href="./IIS.html">IIS</a> and Windows</p><ul><li>Open Source</li><li>Cross-platform</li></ul><blockquote><p>.NET: Document (Data) Object Type (Technologies) Network Enabled Technologies</p></blockquote><p>Old ASP.NET Framework:</p><ul><li>ASP.NET Webform (state-full)</li><li><a href="./ASP_NET_Core_MVC.html">ASP.NET MVC 5</a></li><li>ASP.NET API 2.2</li></ul><p><strong>Why .NET Core?</strong></p><ul><li>Previously too many vertical frameworks: Desktop/Phone/Silverlight/ASP.NET/Web API</li><li>Unify and simply them</li></ul><p><strong>Components of Core:</strong></p><ol><li>.NET Core</li><li>ASP.NET Core</li><li><a href="./../Entity_Framework_Core.html">Entity Framework Core</a></li></ol><h2 id="telemetry" tabindex="-1">Telemetry <a class="header-anchor" href="#telemetry" aria-label="Permalink to “Telemetry”">​</a></h2><p>Telemetry is on by default.</p><ul><li>Set <code>$Env:DOTNET_CLI_TELEMETRY_OPTOUT = 1</code> to opt out</li></ul><h2 id="asp-net-core-project-structure" tabindex="-1">ASP.NET Core Project Structure <a class="header-anchor" href="#asp-net-core-project-structure" aria-label="Permalink to “ASP.NET Core Project Structure”">​</a></h2><ol><li><p><code>[project name].csproj</code>: The Project configuration file, will contain the Target Framework, Nuget package details and other project related settings. This file is used by MSbuild during the build process. For more details visit <a href="https://docs.microsoft.com/en-us/aspnet/web-forms/overview/deployment/web-deployment-in-the-enterprise/understanding-the-project-file" target="_blank" rel="noreferrer">project-file</a>.</p><ul><li><p>Defines how the project will be built</p></li><li><p><code>TargetFramework</code>: Specifies the target framework for the application.</p><ul><li>To specify a target framework we use <em>Target Framework Moniker</em> (TFM).</li><li>E.g. <code>netcoreapp3.1</code></li></ul></li><li><p><code>AspNetCoreHostingModel</code>: Specifies how the application should be hosted</p><ul><li><code>InProcess</code> or <code>OutOfProcess</code></li></ul></li><li><p><code>PackageReference</code>: Used to include a reference to the NuGet package that is installed for the application</p><ul><li>Metapackage - <code>Microsoft.AspNetCore.App</code></li><li>A metagpackage has no content of its own</li><li>It just contains a list of dependencies (other packages)</li><li>When the version is not specified, an implicit version is specified by the SDK</li><li>Rely on the implicit version rather than explicitly setting the version number on the package reference</li></ul></li></ul></li><li><p><code>Properties/launchSettings.json</code>: Which will contain the details for starting the project during development or production environment.</p><ul><li>You can create different profiles based on the requirement.</li><li>Visual Studio will use the profiles defined here to run the project</li></ul></li><li><p><code>appsettings.json</code>: Application configuration file, it store details such as database connection strings, API keys, etc.</p><ul><li>All the application&#39;s settings are contained in this file. (Restart VS after making changes to this file)</li><li>Different environment specific settings can be used, by creating files in the below mentioned format</li><li><code>appsettings.[environment].json</code></li><li><code>appsettings.Development.json</code></li></ul></li><li><p><code>Program.cs</code>: Entry point of the .NET Core applications. Host configuration.</p></li><li><p><code>Startup.cs</code>: Configures services and application request pipelines (middlewares)</p><ul><li><p><strong><code>Program.cs</code> and <code>Startup.cs</code> files are combined into <code>Program.cs</code> file from ASP.NET Core 6+</strong></p></li><li><p><code>public IConfiguration Configuration { get; }</code>: Read configuration settings from multiple sources like <code>appsettings.json</code>, Environment variables, files...</p></li></ul></li></ol><h3 id="http-request-flow" tabindex="-1">HTTP Request Flow <a class="header-anchor" href="#http-request-flow" aria-label="Permalink to “HTTP Request Flow”">​</a></h3><ol><li>When the browser makes a request, it first arrives at a web server like <strong><a href="./IIS.html">IIS</a></strong></li><li><em>IIS</em> will invoke the Dot.NET runtime which will load the CLR</li><li>Now the request looks for an entry point, i.e. <code>main</code> function present in the <code>Program.cs</code> file and execute it</li><li>This will start the internal web server in the application</li><li>The <code>main</code> and <code>startup</code> class will configure the application</li><li>The request will be routed form <em>IIS</em> to <em><a href="./Deployment.html#kestrel">Kestrel</a></em></li><li>Now the request is pushed to the application</li><li>The request will be processed by all the middleware</li><li>The generated response will be routed back to <em>Kestrel</em> that will again pass it to <em>IIS</em>, which will produce the response on the browser</li></ol><h3 id="program-cs-file" tabindex="-1"><code>Program.cs</code> File <a class="header-anchor" href="#program-cs-file" aria-label="Permalink to “Program.cs File”">​</a></h3><p>The application always starts execution from the <code>static Main</code> function present in <code>Program.cs</code> file</p><p>Program is concerned with infrastructure configuration that will typically remain stable throughout the lifetime of the project, such as:</p><ul><li><p>Application Settings: Loads configuration settings (such as <code>appsettings.json</code>) at runtime such as connection strings, usernames and passwords</p></li><li><p>Logging</p></li><li><p>HTTP Server (Kestrel)</p></li><li><p>Content Root</p></li><li><p>IIS Integration</p></li></ul><p>The <code>WebHost.CreateDefaultBuilder()</code> (Core 2.x), <code>Host.CreateDefaultBuilder()</code> (Core 3.x - 5.x), and <code>WebApplication.CreateBuilder()</code> (Core 6+) method performs various tasks:</p><ul><li>Setting up the web server</li><li>Loading the host and application configuration from various configuration sources</li><li>Configuring logging</li><li>Web builder configurations are done in <code>Startup.cs</code> file (before ASP.NET Core 6+)</li></ul><p><em>Example:</em></p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// ASP.NET Core 2.x</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> Program</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Main</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> args</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">        BuildWebHost</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Run</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> static</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IWebHost</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> BuildWebHost</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> args</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        WebHost</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">CreateDefaultBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseStartup</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Startup</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Build</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// ASP.NET Core 3.x - 5.x</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> Program</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Main</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> args</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">        CreateHostBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Build</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Run</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> static</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IHostBuilder</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> CreateHostBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> args</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        Host</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">CreateDefaultBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">ConfigureWebHostDefaults</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">webBuilder</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">            {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">                webBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseStartup</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Startup</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">            });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// ASP.NET Core 6+</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// Single file, no need of \`Startup.cs\` file</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> builder</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> WebApplication</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">CreateBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">builder</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddRazorPages</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> app</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> builder</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Build</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Environment</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">IsDevelopment</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseDeveloperExceptionPage</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseStaticFiles</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MapGet</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">/</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> ()</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Hello World!</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MapRazorPages</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Run</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span></code></pre></div><p>An ASP.NET Core application can be hosted:</p><ul><li><p><code>InProcess</code>:</p><ul><li><code>CreateDefaultBuilder()</code> method calls <code>UseIIS()</code> method and hosts the app inside of the IIS worker process (<code>w3wp.exe</code>) or IIS Express (<code>iisexpress.exe</code>)</li><li><code>InProcess</code> hosting delivers significantly higher request throughput that <code>OutOfProcess</code> hosing</li></ul></li><li><p>Out-Of-Process:</p><ul><li><p>Two ways of hosting:</p><ul><li>Kestrel as the server</li><li>Reverse proxy + Kestrel</li></ul></li><li><p><code>OutOfProcess</code> hosting model forward we requests to a backend ASP.NET Core app running the Kestrel Server</p></li></ul></li></ul><h3 id="startup-cs-file" tabindex="-1"><code>Startup.cs</code> File <a class="header-anchor" href="#startup-cs-file" aria-label="Permalink to “Startup.cs File”">​</a></h3><p>Startup file (<strong>not needed from ASP.NET Core 6+</strong>) is used to configure the majority of your application&#39;s custom behaviour, such as:</p><ul><li>Dependency Injection: To correctly create classes at runtime, dependencies are registered with a container</li><li>Middleware Pipeline</li><li>Endpoint Configuration</li></ul><p>Methods present in the file:</p><ul><li><code>ConfigureServices</code>: Add and configure services, like entity framework, etc..</li><li><code>Configure</code>: Add and configure middle-ware to the pipe line.</li></ul><h3 id="application-configurations" tabindex="-1">Application Configurations <a class="header-anchor" href="#application-configurations" aria-label="Permalink to “Application Configurations”">​</a></h3><ul><li><p>Use the inbuilt ASP.NET Core&#39;s configuration library to create a configuration object</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> readonly</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IConfiguration</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Startup</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">IConfiguration</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    Configuration</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p>Configurations are saved in the <code>appsettings.json</code> file. Custom configurations can be added as key-value pairs:</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">Logging</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">    &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">LogLevel</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">      &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">Default</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Information</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">      &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">Microsoft</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Warning</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">      &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">Microsoft.Hosting.Lifetime</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Information</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">AllowedHosts</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">CustomConfigKey</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">NestedKey</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">    &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">SomeKey</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p>Access the configuration value, same as accessing an objects key-value:</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">CustomConfigKey</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// Access nested configs \`:\` (colon) is used instead of a \`.\` (dot)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">NestedKey:SomeKey</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">]</span></span></code></pre></div></li><li><p>If the custom configuration key is not defined, then it will return null value</p></li><li><p>Value in the right format:</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">GetValue</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">bool</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">CustomConfigKey</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span></code></pre></div></li></ul><p>Configuration management:</p><ul><li><code>appsettings.json</code>: Will contain default values</li><li><code>appsettings.Development.json</code>: Will contain configurations related to development environment</li><li><code>appsettings.Production.json</code>: Will contain configurations related to production environment</li></ul><h2 id="dependency-injection" tabindex="-1">Dependency Injection <a class="header-anchor" href="#dependency-injection" aria-label="Permalink to “Dependency Injection”">​</a></h2><p>ASP.NET Core supports the <a href="./../../../Concepts/Designs/Design_Patterns.html">Dependency Injection</a> (DI) software design pattern, which is a technique for achieving <em>Inversion of Control</em> (IoC) between classes and their dependencies.</p><ul><li>Dependency injection, a development pattern which encourages loose coupling between components.</li></ul><p>Services are typically registered in the app&#39;s Startup.ConfigureServices method.</p><ul><li><p>The <code>Startup.ConfigureServices</code> method accepts one parameter an instance of the <code>IServiceCollection</code> named <code>services</code>. This object exposes a handful of helpful methods that allow you to configure your dependency injection logic:</p><ol><li><p><code>AddScoped</code>: We get the same instance within the scope of a given HTTP request but a new instance across different HTTP requests</p></li><li><p><code>AddSingleton</code>: Single instance is created and used for the entire applications lifetime</p></li><li><p><code>AddTransient</code>: Shortest. A new instance is provided every time an instance is requested whether it is the scope of the same HTTP request or across different HTTP requests</p></li></ol></li><li><p><em>Injection</em> of the service into the constructor of the class where it&#39;s used. The framework takes on the responsibility of creating an instance of the dependency and disposing of it when it&#39;s no longer needed.</p></li><li><p>The collective set of dependencies that must be resolved is typically referred to as a dependency tree, dependency graph, or object graph.</p></li></ul><h2 id="middleware-in-asp-net-core" tabindex="-1">Middleware in ASP.NET Core <a class="header-anchor" href="#middleware-in-asp-net-core" aria-label="Permalink to “Middleware in ASP.NET Core”">​</a></h2><p>Middleware is software that&#39;s assembled into an app pipeline to handle requests and responses. Each component:</p><ul><li><p>Chooses whether to pass the request to the next component in the pipeline.</p></li><li><p>Can perform work before and after the next component in the pipeline.</p></li></ul><p>When the browser sends a request to the server, the request is attached to a context object:</p><ul><li><p>This object is passed to the first pipe which process the request and determines if a response is needed, if not the context is passed along to the next pipe.</p></li><li><p>This process continues till a response is given back to the browser.</p></li><li><p>If the middleware doesn&#39;t pass along the request, it&#39;s called short-circuiting the request pipeline.</p></li><li><p>Short-circuiting is often desirable because it avoids unnecessary work.</p></li><li><p>When a middleware short-circuits, it&#39;s called a terminal middleware because it prevents further middleware from processing the request.</p></li></ul><h3 id="request-delegates" tabindex="-1">Request Delegates <a class="header-anchor" href="#request-delegates" aria-label="Permalink to “Request Delegates”">​</a></h3><ul><li><p>Request delegates are used to build the request pipeline. The request delegates handle each HTTP request.</p></li><li><p>Request delegates are configured using <code>Run</code>, <code>Map</code>, and <code>Use</code> extension methods.</p></li></ul><p>Registering middleware:</p><ol><li><p><code>app.Run(IApplicationBuilder, RequestDelegate)</code>:</p><ul><li>Adds a <em>terminal middleware</em> delegate as it prevents further middleware from processing the request.</li><li>Will never call subsequent middleware</li><li><code>Run</code> delegates don&#39;t receive a <code>next</code> parameter.</li></ul><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Run</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> context</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Response</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">WriteAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Hello world!</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">});</span></span></code></pre></div></li><li><p><code>app.Use</code>: If you want to pass the request to the next delegate use <code>app.Use</code> instead of <code>app.Run</code>.</p><ul><li>The <code>next</code> parameter represents the next delegate in the pipeline.</li><li>You can <em>short-circuit</em> the pipeline by not calling the <code>next</code> parameter.</li><li>You can typically perform actions both before and after the <code>next</code> delegate</li></ul><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Use</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> next</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // Do work that doesn&#39;t write to the Response.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> next</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Invoke</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // Do logging or other work that doesn&#39;t write to the Response.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">});</span></span></code></pre></div></li><li><p><code>app.Map</code>: extensions are used as a convention for branching the pipeline.</p><ul><li><code>Map</code> branches the request pipeline based on matches of the given request path.</li><li>If the request path starts with the given path, the branch is executed.</li></ul><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Map</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">/map1</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> HandleMapTest1</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Map</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">/map2</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> HandleMapTest2</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Run</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> context</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Response</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">WriteAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Hello from non-Map delegate. &lt;p&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Run</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">static</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> HandleMapTest1</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IApplicationBuilder</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Run</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> context</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">        await</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Response</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">WriteAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Map Test 1</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">static</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> HandleMapTest2</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IApplicationBuilder</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Run</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> context</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">        await</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Response</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">WriteAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Map Test 2</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div></li></ol><h3 id="middleware-order" tabindex="-1">Middleware Order <a class="header-anchor" href="#middleware-order" aria-label="Permalink to “Middleware Order”">​</a></h3><ul><li><p>Middlewares are executed on the order they are added</p></li><li><p>The order in which the middleware are registered matter</p></li></ul><p><em>Example:</em> ASP.NET Core MVC and Razor Pages apps request processing pipeline:</p><p><img src="/assets/middleware-pipeline.Co9vTXDS.svg" alt="middleware pipeline"></p><p><em>Example:</em></p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// Middleware that is not added when creating a new web app with individual users accounts is commented out.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Configure</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IApplicationBuilder</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IWebHostEnvironment</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> env</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">env</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">IsDevelopment</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseDeveloperExceptionPage</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseDatabaseErrorPage</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseExceptionHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">/Error</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">        // Adds the &quot;Strict-Transport-Security&quot; header</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseHsts</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // Redirects HTTP requests to HTTPS</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseHttpsRedirection</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // Returns static files and short-circuits further request processing</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseStaticFiles</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // Conforms the app to the EU General Data Protection Regulation (GDPR) regulations.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // app.UseCookiePolicy();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseRouting</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // app.UseRequestLocalization();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // app.UseCors();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // Attempts to authenticate the user before they&#39;re allowed access to secure resources</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseAuthentication</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // Authorizes a user to access secure resources</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseAuthorization</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // Establishes and maintains session state. If the app uses session state, call Session Middleware after Cookie Policy Middleware and before MVC Middleware</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // app.UseSession();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // app.UseResponseCompression();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // app.UseResponseCaching();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    // Add Razor Pages endpoints to the request pipeline</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseEndpoints</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">endpoints</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        endpoints</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MapRazorPages</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        endpoints</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MapControllerRoute</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">            name</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">default</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">            pattern</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">{controller=Home}/{action=Index}/{id?}</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div><p>Recommendations regarding order:</p><ul><li><p><code>UseCors</code>, <code>UseAuthentication</code>, and <code>UseAuthorization</code> must appear in the order shown.</p></li><li><p><code>UseCors</code> currently must appear before <code>UseResponseCaching</code> due to a bug.</p></li><li><p><code>UseRequestLocalization</code> must appear before any middleware that might check the request culture (for example, <code>app.UseMvcWithDefaultRoute()</code>).</p></li></ul><h2 id="routing" tabindex="-1">Routing <a class="header-anchor" href="#routing" aria-label="Permalink to “Routing”">​</a></h2><p>Routing is responsible for matching incoming HTTP requests and dispatching those requests to the app&#39;s executable endpoints.</p><ul><li>Endpoints are the app&#39;s units of executable request-handling code.</li><li>Endpoints are defined in the app and configured when the app starts.</li><li>The endpoint matching process can extract values from the request&#39;s URL and provide those values for request processing.</li><li>Using endpoint information from the app, routing is also able to generate URLs that map to endpoints.</li></ul><p>ASP.NET Core controllers use the Routing middleware to match the URLs of incoming requests and map them to actions.</p><p>Routing uses a pair of middlewares:</p><ol><li><p><code>UseRouting</code>: Matches request to an endpoint.</p></li><li><p><code>UseEndpoints</code>: Execute the matched endpoint.</p></li></ol><div class="tip custom-block"><p class="custom-block-title">NOTE</p><p>In Core 6.0, the <code>WebApplicationBuilder</code> implicitly calls <code>UseRouting</code> and <code>UseEndpoints</code>.</p><ul><li>Apps can change the order in which <code>UseRouting</code> and <code>UseEndpoints</code> run by calling these explicitly</li></ul></div><p>Route templates:</p><ul><li>Are defined in startup code or attributes.</li><li>Describe how URL paths are matched to actions.</li><li>Are used to generate URLs for links. The generated links are typically returned in responses.</li></ul><p>Types of Routing:</p><ol><li><p>Conventional routing: typically used with controllers and views.</p><ul><li><p>Routing Configuration:</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseEndpoints</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">endpoints</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    endpoints</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MapControllerRoute</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">default</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">        pattern</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">{controller=Home}/{action=Index}/{id?}</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">});</span></span></code></pre></div></li><li><p>The single route is named <code>default</code> route</p></li><li><p>The route template <code>&quot;{controller=Home}/{action=Index}/{id?}&quot;</code>:</p><ul><li>Matches a URL path like <code>/Products/Details/5</code></li><li><code>Home</code> is default controller</li><li><code>Index</code> is default action</li><li><code>?</code> defines <code>id</code> as optional</li></ul></li></ul></li><li><p>Attribute routing: <strong>preferred with REST APIs</strong></p><ul><li><p>Placing a route on the controller or action makes it attribute-routed.</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> ConfigureServices</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IServiceCollection</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddControllers</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Configure</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IApplicationBuilder</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IWebHostEnvironment</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> env</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseRouting</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseEndpoints</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">endpoints</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        endpoints</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MapControllers</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p>The <code>HomeController.Index</code> action is run for any of the URL paths <code>/</code>, <code>/Home</code>, <code>/Home/Index</code>, or <code>/Home/Index/3</code>:</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> HomeController</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> ControllerBase</span><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"> // Controller</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Home</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Home/Index</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Home/Index/{id?}</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Index</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">?</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> ControllerContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MyDisplayRouteInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Home/About</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Home/About/{id?}</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> About</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">?</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> ControllerContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MyDisplayRouteInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p>Using token replacement. The tokens <code>[action]</code>, <code>[area]</code>, and <code>[controller]</code> are replaced with the values of the action name, area name, and controller name from the action where the route is defined:</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> HomeController</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> Controller</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Home</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">[controller]/[action]</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Index</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> ControllerContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MyDisplayRouteInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">[controller]/[action]</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> About</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> ControllerContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MyDisplayRouteInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">[controller]/[action]</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> HomeController</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> Controller</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">~/</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">/Home</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">~/Home/Index</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Index</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> ControllerContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MyDisplayRouteInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> About</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> ControllerContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MyDisplayRouteInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div></li></ul></li></ol><p>Reserved routing names:</p><ul><li><code>action</code></li><li><code>area</code></li><li><code>controller</code></li><li><code>handler</code></li><li><code>page</code></li></ul><p>HTTP verb templates:</p><ul><li><code>[HttpGet]</code></li><li><code>[HttpPost]</code></li><li><code>[HttpPut]</code></li><li><code>[HttpDelete]</code></li><li><code>[HttpHead]</code></li><li><code>[HttpPatch]</code></li></ul><p>Route templates:</p><ul><li>All the HTTP verb templates are route templates.</li><li><code>[Route]</code></li></ul><p><em>Example:</em></p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Route</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">api/[controller]</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">ApiController</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> Test2Controller</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> ControllerBase</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">HttpGet</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">]</span><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">   // GET /api/test2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> ListProducts</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> ControllerContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MyDisplayRouteInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">HttpGet</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">{id}</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">   // GET /api/test2/xyz</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> GetProduct</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">       return</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> ControllerContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MyDisplayRouteInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">HttpGet</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">int/{id:int}</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"> // GET /api/test2/int/3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> GetIntProduct</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">        // Returns &quot;404 Not Found&quot; if non-numeric value is passed</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> ControllerContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MyDisplayRouteInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">HttpGet</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">int2/{id}</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">  // GET /api/test2/int2/3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> GetInt2Product</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">        // Returns &quot;400 Bad Request&quot; if non-numeric value is passed</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> ControllerContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MyDisplayRouteInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div><p>Route name: can be used to generate a URL based on a specific route. Route names:</p><ul><li>Have no impact on the URL matching behaviour of routing.</li><li>Are only used for URL generation.</li><li>Route names must be unique application-wide</li></ul><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">HttpGet</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">/products2/{id}</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Name</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Products_List</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// or using \`nameof()\`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">HttpGet</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">/products2/{id}</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Name</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> nameof</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">GetProduct</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">))]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IActionResult</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> GetProduct</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> ControllerContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MyDisplayRouteInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">id</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div><h2 id="authentication" tabindex="-1">Authentication <a class="header-anchor" href="#authentication" aria-label="Permalink to “Authentication”">​</a></h2><p>Authentication is identifying who the user is</p><p>ASP.NET Core Identity:</p><ul><li><p>Is an API that supports user interface (UI) login functionality.</p></li><li><p>Manages users, passwords, profile data, roles, claims, tokens, email confirmation, and more.</p></li></ul><p>Steps to add Identity to the application:</p><ol><li><p>Inherit from <code>IdentityDbContext</code> class instead of <code>DbContext</code>, as this class provides all the <code>DbSet</code> properties needed to manage the identity tables in the underlying data store</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> AppDbContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IdentityDbContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IdentityUser</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> AppDbContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">DbContextOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">AppDbContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> :</span><span style="--shiki-light:#005CC5;--shiki-dark:#C99076;"> base</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p>Add ASP.NET Core Identity services to the application:</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// IdentityUser and IdentityRole are built-in class</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// Here EntityFramework is used to handle the database</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddIdentity</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IdentityUser</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IdentityRole</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddEntityFrameworkStores</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">AppDbContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;();</span></span></code></pre></div><ul><li>The built-in classes have limited properties, if we need to store more information about the user: <ul><li>Create a class that inherits from <code>IdentityUser</code> and extends it with new properties</li><li>Then replace <code>IdentityUser</code> with the new class in the <code>AddIdentity</code> service</li></ul></li></ul></li><li><p>Add the <code>UseAuthentication()</code> middleware:</p></li><li><p>Create migration and update database, so that the required Identity tables are created</p></li><li><p>Add the <code>[Authorize]</code> attribute to the controller or the actions that needs authentication</p></li><li><p>Add the <code>[AllowAnonymous]</code> attribute to allow unauthenticated users</p></li></ol><div class="tip custom-block"><p class="custom-block-title">NOTE</p><ul><li><p>If <code>[Authorize]</code> on the controller and <code>[AllowAnonymous]</code> on the action works</p></li><li><p>If <code>[AllowAnonymous]</code> on the controller and <code>[Authorize]</code> on the action will not work. That action can be accessed by unauthenticated users</p></li></ul></div><h3 id="user-management" tabindex="-1">User Management <a class="header-anchor" href="#user-management" aria-label="Permalink to “User Management”">​</a></h3><ul><li><p><code>UserManager&lt;IdentityUser&gt;</code>: Provides the APIs for managing user in a persistence store.</p></li><li><p><code>SignInManager&lt;IdentityUser&gt;</code>: Provides the APIs for user sign in.</p></li></ul><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">AllowAnonymous</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> CustomerController</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> Controller</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> readonly</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> UserManager</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IdentityUser</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> _userManager</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> readonly</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> SignInManager</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IdentityUser</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> _signInManager</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> CustomerController</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">UserManager</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IdentityUser</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> userManager</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> SignInManager</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IdentityUser</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> signInManager</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        _userManager</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> userManager</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        _signInManager</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> signInManager</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">HttpPost</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> Task</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IActionResult</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> CreateCustomerAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">([</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">FromBody</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> UserModel</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> user</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> newUser</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IdentityUser</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">            UserName</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> user</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">UserName</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">            Email</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> user</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Email</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">        var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> userManager</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">CreateAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">newUser</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> user</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Password</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Succeeded</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">            await</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> signInManager</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">SignInAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> isPersistent</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> RedirectToAction</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">/</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">        foreach</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> error</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Errors</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div><h3 id="configure-identity-services" tabindex="-1">Configure Identity Services <a class="header-anchor" href="#configure-identity-services" aria-label="Permalink to “Configure Identity Services”">​</a></h3><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> ConfigureServices</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IServiceCollection</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Configure</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IdentityOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">        // Password settings.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Password</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">RequireDigit</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Password</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">RequireLowercase</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Password</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">RequireNonAlphanumeric</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Password</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">RequireUppercase</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Password</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">RequiredLength</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Password</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">RequiredUniqueChars</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">        // Lockout settings.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Lockout</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">DefaultLockoutTimeSpan</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> TimeSpan</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">FromMinutes</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Lockout</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">MaxFailedAccessAttempts</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Lockout</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">AllowedForNewUsers</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">        // User settings.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">AllowedUserNameCharacters</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">        &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._@+</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">RequireUniqueEmail</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">ConfigureApplicationCookie</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">        // Cookie settings</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">HttpOnly</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">ExpireTimeSpan</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> TimeSpan</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">FromMinutes</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">LoginPath</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">/Identity/Account/Login</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">AccessDeniedPath</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">/Identity/Account/AccessDenied</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">SlidingExpiration</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div><h2 id="authorization" tabindex="-1">Authorization <a class="header-anchor" href="#authorization" aria-label="Permalink to “Authorization”">​</a></h2><p>Authorization is identifying what the user can and cannot do</p><p>Role management:</p><ul><li><code>RoleManager&lt;IdentityRole&gt;</code>: Provides the APIs for managing roles in a persistence store</li></ul><table tabindex="0"><thead><tr><th>Role</th><th>Claims</th></tr></thead></table><p>In ASP.NET Core, a Role is a Claim with Type Role</p><h3 id="role-based-authorization" tabindex="-1">Role Based Authorization <a class="header-anchor" href="#role-based-authorization" aria-label="Permalink to “Role Based Authorization”">​</a></h3><p>Roles</p><ul><li>Boolean</li><li>Encapsulating: <ul><li>Users</li><li>Functions</li></ul></li></ul><h3 id="claims-based-authorization" tabindex="-1">Claims Based Authorization <a class="header-anchor" href="#claims-based-authorization" aria-label="Permalink to “Claims Based Authorization”">​</a></h3><p>Claims: A claim is a name-value pair that represents what the subject is, not what the subject can do</p><ul><li><p>Key-Value pair</p></li><li><p>User property</p></li><li><p>Describes the user</p></li><li><p><code>ClaimType</code> comparison is case in-sensitive</p></li><li><p><code>ClaimValue</code> comparison is case sensitive</p></li></ul><h3 id="policy" tabindex="-1">Policy <a class="header-anchor" href="#policy" aria-label="Permalink to “Policy”">​</a></h3><ul><li>Authorization Function</li></ul><h3 id="external-identity-providers" tabindex="-1">External Identity Providers <a class="header-anchor" href="#external-identity-providers" aria-label="Permalink to “External Identity Providers”">​</a></h3><p>Trusted External Identity Providers such as:</p><ul><li>Google</li><li>Microsoft</li><li>Facebook</li><li>Twitter</li></ul><p>Steps for the integration: In all cases, we must complete an application registration procedure that is vendor dependent and that usually involves:</p><ol><li><p>Getting a Client Application ID</p></li><li><p>Getting a Client Application Secret</p></li><li><p>Configuring a redirection URL, that&#39;s handled by the authorization middleware and the registered provider</p></li><li><p>Optionally, configuring a sign-out URL to properly handle sign out in a Single Sign On (SSO) scenario</p></li></ol><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> ConfigureServices</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IServiceCollection</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    //...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddAuthentication</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddMicrosoftAccount</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">microsoftOptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">            microsoftOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">ClientId</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> Configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Authentication:Microsoft:ClientId</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">            microsoftOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">ClientSecret</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> Configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Authentication:Microsoft:ClientSecret</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddGoogle</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">googleOptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> ..</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">. </span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddTwitter</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">twitterOptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> ..</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">. </span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddFacebook</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">facebookOptions</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> ..</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">. </span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">});</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">    //...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div><h2 id="response-compression" tabindex="-1">Response Compression <a class="header-anchor" href="#response-compression" aria-label="Permalink to “Response Compression”">​</a></h2><ul><li><p>At the reverse proxy layer (IIS, Nginx, Apache). Handling compression at reverse proxy layer is better because these servers are typically much faster and more efficient at compressing responses</p></li><li><p>Or use <code>Microsoft.AspNetCore.ResponseCompression</code> to handle compression in the application</p></li></ul><h2 id="json-serialization" tabindex="-1">JSON Serialization <a class="header-anchor" href="#json-serialization" aria-label="Permalink to “JSON Serialization”">​</a></h2><p>Parse (de-serialize) JSON to object notations</p><ul><li><p><code>JSON.Net</code> by <em>Newtonsoft</em></p></li><li><p><code>System.Text.Json</code>: .NET 3+ and should be preferred. Not all features are implemented</p></li><li><p>De-serialize an Object:</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> Account</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Email</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> get</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> bool</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Active</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> get</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> DateTime</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> CreatedDate</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> get</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    public</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IList</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Roles</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> get</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> json</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> @&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">  &#39;Email&#39;: &#39;james@example.com&#39;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">  &#39;Active&#39;: true,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">  &#39;CreatedDate&#39;: &#39;2013-01-20T00:00:00Z&#39;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">  &#39;Roles&#39;: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">    &#39;User&#39;,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">    &#39;Admin&#39;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">  ]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Account</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> account</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> JsonConvert</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">DeserializeObject</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Account</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Console</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">WriteLine</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">account</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Email</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// james@example.com</span></span></code></pre></div></li><li><p>Serialize an Object</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Account</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> account</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> Account</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    Email</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">james@example.com</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    Active</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    CreatedDate</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> DateTime</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;">2013</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;"> 20</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> DateTimeKind</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Utc</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    Roles</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> List</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">        &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">User</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">        &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Admin</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> json</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> JsonConvert</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">SerializeObject</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">account</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> Formatting</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Indented</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">//   &quot;Email&quot;: &quot;james@example.com&quot;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">//   &quot;Active&quot;: true,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">//   &quot;CreatedDate&quot;: &quot;2013-01-20T00:00:00Z&quot;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">//   &quot;Roles&quot;: [</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">//     &quot;User&quot;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">//     &quot;Admin&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">//   ]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// }</span></span></code></pre></div></li></ul><h2 id="secret-manager" tabindex="-1">Secret Manager <a class="header-anchor" href="#secret-manager" aria-label="Permalink to “Secret Manager”">​</a></h2><p>Keeps production secrets like database connection strings, API and encryption keys out of source control</p><ul><li><p><strong>Meant to be used for development purpose only</strong></p></li><li><p>The secrets are stored as plain text in the <code>secrets.json</code> file located in <code>C:\\Users\\{UserName}\\AppData\\Roaming\\Microsoft\\UserSecrets\\{ID}\\</code></p><ul><li><code>UserName</code>: is the current windows user</li><li><code>ID</code>: Random GUID used to link secrets with a particular project</li></ul></li><li><p>No configuration changes needed</p></li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"># initialize</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">dotnet</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> user-secrets</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> init</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"># add secret</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">dotnet</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> user-secrets</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> MongoDbSettings:Password</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> Pass#word1</span></span></code></pre></div><h2 id="email-confirmation" tabindex="-1">Email Confirmation <a class="header-anchor" href="#email-confirmation" aria-label="Permalink to “Email Confirmation”">​</a></h2><ul><li>Prevents accidental account hijacking</li><li>Reduces spam registration</li><li>Prevents unsolicited emails</li><li>Easy to recover account</li></ul><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddIdentity</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IdentityUser</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> IdentityRole</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">            //...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">            options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">SignIn</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">RequireConfirmedEmail</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        }).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddEntityFrameworkStores</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">AppDbContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;();</span></span></code></pre></div><ul><li><p>Generate email confirmation token:</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> token</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> userManager</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">GenerateEmailConfirmationTokenAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span></code></pre></div></li><li><p>Generate email confirmation link:</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> confirmationLink</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> Url</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Action</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">ConfirmEmail</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Account</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> userId</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> user</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Id</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> token</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> token</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> },</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> Request</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Scheme</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span></code></pre></div></li></ul><h2 id="encryption" tabindex="-1">Encryption <a class="header-anchor" href="#encryption" aria-label="Permalink to “Encryption”">​</a></h2><p>Data Protection API (DPAPI) can be used</p><h2 id="nuget-packages" tabindex="-1">Nuget Packages <a class="header-anchor" href="#nuget-packages" aria-label="Permalink to “Nuget Packages”">​</a></h2><ol><li><p>Use <code>Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation</code> Nuget package to hot reload. Also add <code>app.AddRazorPages().AddRazorRuntimeCompilation()</code> to Startup file.</p></li><li><p><code>Microsoft.EntityFrameworkCore</code> to access Database. <code>Microsoft.EntityFrameworkCore.SqlServer</code> for SqlServer. For Sqlite use <a href="https://docs.microsoft.com/en-us/ef/core/get-started/?tabs=visual-studio" target="_blank" rel="noreferrer">Sqlite EntityFramework</a>. <code>Microsoft.EntityFrameworkCore.Tools</code> to run migrations. Add the below connection string in <code>appsettings.json</code> file:</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">ConnectionStrings</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">    &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">DefaultConnection</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Server=(LocalDb)</span><span style="--shiki-light:#005CC5;--shiki-dark:#C99076;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">MSSQLocalDB:...</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div><p>Connection String is found in the respective SQL Application.</p></li></ol><h2 id="versions" tabindex="-1">Versions <a class="header-anchor" href="#versions" aria-label="Permalink to “Versions”">​</a></h2><p>To target older ASP.NET Core versions add a <code>global.json</code> file to the working directory:</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">sdk</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">    &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A965;">version</span><span style="--shiki-light:#005CC5;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">1.1.9</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div><h3 id="asp-net-core-1-0" tabindex="-1">ASP.NET Core 1.0 <a class="header-anchor" href="#asp-net-core-1-0" aria-label="Permalink to “ASP.NET Core 1.0”">​</a></h3><ul><li><p>27 June 2016 (VS 2015 update 3)</p></li><li><p>Used a <code>project.json</code> file for project and package configuration, references</p></li><li><p>Improved separations of concerns between content and resources</p><ul><li>Public, static resources (CSS, JavaScript, images) in <code>wwwroot</code> directory</li></ul></li><li><p>VS 2017 moved back to <code>.csproj</code> file from <code>project.json</code></p><ul><li>Change allows for MSBuild support</li><li>Project file updates: <ul><li>Removed list of <code>included</code> files</li><li>Manage NuGet package references</li></ul></li></ul></li></ul><h4 id="dependency-injection-built-in" tabindex="-1">Dependency Injection Built-In <a class="header-anchor" href="#dependency-injection-built-in" aria-label="Permalink to “Dependency Injection Built-In”">​</a></h4><p>Dependency injection is completely built in:</p><ul><li><p>No need to bring in <strong>Ninject</strong> or <strong>Autofac</strong> etc.</p></li><li><p>Items added to the services container in <code>Startup.cs</code></p></li><li><p>Services are accessed through:</p><ul><li>Constructor injection</li><li>Method injection (with <code>[FromServices]</code>)</li><li>View injection (with <code>@inject</code>)</li><li><code>ApplicationServices</code> (for non-controller classes) (NOT DI)</li><li><code>HttpContext.RequestServices</code> (for controllers) (NOT DI)</li><li>Injection is the preferred mechanism</li></ul></li><li><p>Custom services can be registered as well:</p><ul><li>Transient: created each time there is a request (by any class)</li><li>Scoped: created once per request (HTTP request)</li><li>Singleton: max of one instance per application</li><li>Instance: similar to singleton, but created when instance is called</li></ul></li></ul><h3 id="bundling-minification" tabindex="-1">Bundling &amp; Minification <a class="header-anchor" href="#bundling-minification" aria-label="Permalink to “Bundling &amp; Minification”">​</a></h3><ul><li><p>Configured with <code>bundleconfig.json</code></p></li><li><p>Bundler &amp; Minifier VS extension</p><ul><li>Includes file watcher for <code>bundleconfig.json</code></li><li>Bundle on build requires additional NuGet package</li><li>Set bindings with Task Runner Explorer</li></ul></li><li><p><code>BundlerMinifierCore</code> works with .NET Core CLI</p><ul><li>Must manually configure <code>.csproj</code> file</li><li>Execute with &quot;dotnet bundle&quot; or &quot;dotnet bundle clean&quot;</li></ul></li></ul><h4 id="environment-awareness-configuration" tabindex="-1">Environment Awareness &amp; Configuration <a class="header-anchor" href="#environment-awareness-configuration" aria-label="Permalink to “Environment Awareness &amp; Configuration”">​</a></h4><ul><li><p>ASP.NET Core uses <code>ASPNETCORE_ENVIRONMENT</code> variable</p><ul><li>Development, Staging, Production are built-in environments</li></ul></li><li><p>Determining which configuration files to load</p></li><li><p>Running different code based on environment using <code>IHostingEnvironment env</code>:</p><ul><li>Use <code>env.EnvironmentName</code></li><li>Use <code>env.IsDevelopment()</code></li></ul></li><li><p>Environment Tag Helper</p></li><li><p>Applications are configured using:</p><ul><li><p>Simple JSON (or other file types)</p></li><li><p>CLI arguments</p></li><li><p>Environment variables</p></li><li><p>In-memory .NET objects</p></li><li><p>Encrypted user store</p></li><li><p>Custom providers</p></li><li><p>Configuration values are set in the order received</p></li><li><p>Environment determines which additional files to load:</p><ul><li><code>appsettings.&lt;environment&gt;.json</code></li></ul></li><li><p>Custom classes can represent configuration values:</p><ul><li><p>Can bind to entire configuration or individual sections with <code>services.Configure&lt;T&gt;</code></p></li><li><p>Requires the <code>Microsoft.Extensions.Options.ConfigurationExtensions</code> package</p></li><li><p>Can be added to DI container and injection in with <code>IOption&lt;T&gt;</code></p></li></ul></li><li><p>Added in 1.1</p><ul><li><code>ReloadOnChange</code> for <code>AddJsonFile</code> and <code>IOptionsSnapshot</code> for object injection</li><li>Azure Key Vault configuration provider</li></ul></li><li><p>Changed in 2.0</p><ul><li>Configuration is loaded using <code>CreateDefaultBuilder</code></li></ul></li></ul></li></ul><h4 id="web-host-configuration-ssl" tabindex="-1">Web host configuration &amp; SSL <a class="header-anchor" href="#web-host-configuration-ssl" aria-label="Permalink to “Web host configuration &amp; SSL”">​</a></h4><ul><li><p>Create a Web host:</p><ul><li>ASP.NET Core application are console applications that create a web host <ul><li>Kestrel in 1.0</li></ul></li><li>The web host is created with the <code>WebHostBuilder</code> class <ul><li>Responsible for app startup and lifetime management</li></ul></li><li>At min, it configures a server and request processing pipeline</li><li>Additional features and configuration are opt-in: <ul><li><code>UseIISIntegration</code> adds IIS with reverse proxy</li><li><code>UseStartup&lt;T&gt;</code> adds configuration (Configure and ConfigureServices)</li></ul></li></ul></li><li><p><strong>Changed in 1.1</strong></p><ul><li>Added <code>HTTP.sys IServer</code> (called <code>WebListener</code> in 1.1)</li></ul></li><li><p><strong>Changed in 2.0</strong></p><ul><li><code>CreateDefaultBuilder</code> configures standard <code>IWebHostBuilder</code></li><li>Many additional options added to <code>WebHostBuilder</code></li></ul></li></ul><p><em>Example:</em> Create a web host</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> Program</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">  public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Main</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> args</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">  {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> host</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> WebHostBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">                    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseKestrel</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">                    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseContentRoot</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Directory</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">GetCurrentDirectory</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">                    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseIISIntegration</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">                    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseStartup</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">Startup</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">                    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseApplicationInsights</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">                    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Build</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    host</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">Run</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div><ol><li><p>Using SSL Locally: IIS</p><ul><li><p>Check Enable SSL on Debug project property page</p></li><li><p>Configure MVC for SSLPort (44300 or greater)</p></li><li><p>Add RequireHttps attribute/filter/etc.</p></li><li><p>Add <code>iisSettings.iisExpress.sslPort: 44329</code> to <code>launchSettings.json</code> file</p></li><li><p>If you have not already trusted it. You&#39;ll get an exception in the browser.</p></li><li><p><strong>Added in 1.1:</strong></p><ul><li>URL rewriting to HTTPS</li></ul></li></ul><p><em>Example:</em></p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> ConfigureServices</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IServiceCollection</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">  // services.AddMvc(options =&gt; options.SslPort = 44329);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">  var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> sslPort</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> Configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">GetValue</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">&gt;(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">iisSettings:iisExpress:sslPort</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">  services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddMvc</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> options</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">SslPort</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> sslPort</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// Add HTTPS attributes to the controllers</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">RequireHttps</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> AccountController</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;"> :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> Controller</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p>Using SSL Locally: Kestrel</p><ul><li>Install the desktop development with C++ workload</li><li>Need the <code>Microsoft.AspNetCore.Server.Kestrel.Https</code> package</li><li>Make a cert, convert to <code>.pfx</code> format</li><li>Make <code>.pfx</code> file into X509 certificate, add it to Kestrel options, specify ports</li><li>Add <code>RequireHttps</code> attribute, configure MVC for SSLPort</li></ul></li></ol><ul><li><p><strong>Added in 1.1:</strong></p><ul><li>URL rewriting to HTTPS</li></ul></li><li><p><strong>Changed in 2.0:</strong></p><ul><li>Kestrel configuration (breaking changes)</li></ul></li><li><p><strong>Changed in 2.1</strong></p><ul><li>HTTPS on by default in development</li><li>Addition of specialized middleware for redirects</li><li>Kestrel listens on <code>https://localhost:5001</code> with dev certificate</li></ul></li></ul><h4 id="application-startup" tabindex="-1">Application Startup <a class="header-anchor" href="#application-startup" aria-label="Permalink to “Application Startup”">​</a></h4><ul><li><p>The <code>Startup</code> class configures services and application pipeline</p></li><li><p>The Constructor creates the configuration builder and configures user secrets (if needed)</p></li><li><p>The <code>Configure</code> method sets up how application will respond to HTTP requests</p></li><li><p>The <code>ConfigureServices</code> method configures services and DI</p></li><li><p><strong>Changed in 2.0</strong></p><ul><li>Configuration created in <code>DefaultWebHostBuilder</code>, injected into <code>Startup.cs</code></li></ul></li></ul><h4 id="standard-logging-is-built-in" tabindex="-1">Standard Logging Is Built-In <a class="header-anchor" href="#standard-logging-is-built-in" aria-label="Permalink to “Standard Logging Is Built-In”">​</a></h4><p>ASP.NET Core provides <code>ILoggerFactory</code> available in Startup&#39;s Configure method</p><ul><li><p>Additional built-in or third-party providers can be added</p></li><li><p><code>LoggerFactory</code> available through injection using <code>ILogger&lt;T&gt;</code></p></li><li><p><strong>Changed in 2.0:</strong></p><ul><li>Logging incorporated in DI system by default</li><li>Configured in <code>Program.cs</code> instead of <code>Startup.cs</code></li></ul></li></ul><h4 id="controllers-and-actions" tabindex="-1">Controllers and Actions <a class="header-anchor" href="#controllers-and-actions" aria-label="Permalink to “Controllers and Actions”">​</a></h4><ul><li>Controller, AsyncController, APIController all rolled into one</li><li>All return <code>IActionResult</code> (or <code>Task&lt;IActionResult&gt;</code>) or its derivatives</li><li>many helper methods built into base controller for returning <code>HttpStatusCodes</code>: <ul><li><code>NoContent(204)</code>, <code>OK(200)</code>, <code>BadRequest(400)</code>, etc</li></ul></li><li>API methods must specify HTTP verb (as opposed to API 2.2) <ul><li>No longer based on name of method</li></ul></li></ul><h4 id="tag-helpers" tabindex="-1">Tag Helpers <a class="header-anchor" href="#tag-helpers" aria-label="Permalink to “Tag Helpers”">​</a></h4><p>New in ASP.NET Core</p><ul><li><p>Enable server-side code to participate in rendering HTML elements in Razor views</p></li><li><p>Reduces the transition between code and markup</p><ul><li>Keeps developers and designers in the HTML</li></ul></li><li><p>Attach to HTML elements in views:</p><ul><li>HTML Helpers are invoked as methods</li><li>Custom Tag Helpers can be created</li></ul></li></ul><p>Form Tag Helper:</p><ul><li><p>Support tags (must include at least one)</p><ul><li><code>asp-area</code></li><li><code>asp-controller</code></li><li><code>asp-action</code></li><li><code>asp-antiforgery</code> (true by default)</li><li><code>asp-rout-[parametername]</code> (e.g. <code>asp-route-id=&quot;1&quot;</code>)</li><li><code>asp-all-route-data</code>: Uses a dictionary for the route data</li><li><code>asp-route</code> (for named routes)</li></ul></li><li><p>Area, Controller, Action are defaulted to current route</p></li><li><p>Equivalent functionality to <code>@Html.BeginForm/EndForm</code></p></li></ul><p>Form Field Tag Helpers:</p><ul><li>Include, Input, TextArea, Select Tag Helpers</li><li>Model property is selected with <code>asp-for</code><ul><li>Provides strong typing with model properties</li></ul></li><li>Generate Id and Name values based on model property</li><li>Add HTML5 validation attributes based on data annotations</li></ul><p>Input:</p><ul><li>Adds HTML type based on .NET data type or data annotation: <ul><li>For example, <code>Bool</code> =&gt; <code>type=&quot;checkbox</code>, <code>[EmailAddress]</code> =&gt; <code>type=&quot;email&quot;</code></li></ul></li><li>Equivalent to <code>@Html.TextBoxFor</code> or <code>@Html.EditorFor</code></li></ul><p>TextArea:</p><ul><li>Equivalent to <code>@Html.TextAreaFor</code></li></ul><p>Select:</p><ul><li>Generates option elements based on &quot;asp-items&quot; attribute</li><li>Equivalent to <code>@Html.DropDownListFor</code> or <code>@Html.ListBoxFor</code></li></ul><p>Label:</p><ul><li>Property selected with <code>asp-for</code></li><li>Generates label caption and &quot;for&quot; attribute</li><li>Equivalent to <code>@Html.LabelFor</code></li></ul><p>Validation Tag Helpers:</p><ul><li><p>Validation message:</p><ul><li>Property selected with <code>asp-validation-for</code></li><li>Generates <code>data-valmsg-for</code> attribute</li><li>Equivalent to <code>@Html.ValidationMessageFor</code></li></ul></li><li><p>Validation summary:</p><ul><li>Enabled with <code>asp-validation-summary</code></li><li>Equivalent to <code>@Html.ValidationSummary</code></li></ul></li></ul><p>Non-Form Tag Helpers:</p><ul><li><p>Anchor: additionally supports:</p><ul><li><code>asp-fragment</code></li><li><code>asp-hostname</code></li></ul></li><li><p>Environment:</p><ul><li>Conditionally renders content based on the runtime environment</li><li>The &quot;names&quot; attribute accepts one or more environment names</li><li>If <code>HostingEnvironment.EnvironmentName</code> matches, content is loaded</li><li><strong>Changed in 2.0:</strong><ul><li>Added the <code>include</code> and <code>exclude</code> attributes</li></ul></li></ul></li><li><p>Link/Script/Image:</p><ul><li>Link: <ul><li><code>asp-append-version</code> tag adds hash of file to URL</li><li>Resolves issue of file still cached when contents change</li><li>Adds <code>?v=[hash of file]</code> to the URL</li></ul></li></ul></li><li><p>Cache/Distributed Cache:</p><ul><li><p>Provides a way to mark content as cached using the <code>[cache]</code> tag</p></li><li><p>Supports absolute, time-span, or sliding expiration</p></li><li><p>Supports additional cache options</p></li><li><p>Distributed Cache Tag helper:</p><ul><li>Inherits from Cache Tag Helper</li><li>Supports SQL Server or Redis as a distributed cache</li></ul></li></ul></li></ul><p>Custom Tag Helpers:</p><ul><li>Derive from <code>TagHelper</code></li><li>Public properties become lower-kebab-cased attributes</li><li>Process method builds the rendered tag</li><li>Assembly containing custom Tag Helpers must be registered in <code>_ViewImports.cshtml</code></li></ul><h4 id="view-components" tabindex="-1">View Components <a class="header-anchor" href="#view-components" aria-label="Permalink to “View Components”">​</a></h4><p>View Components combine server-side code with partial views:</p><ul><li>Used to render a chunk of the response</li></ul><p>Limitations:</p><ul><li>Can&#39;t serve as a client-side end point</li><li>Don&#39;t use model binding</li><li>Don&#39;t participate in controller lifecycle</li></ul><p>Create <code>ViewComponent</code> Class:</p><ul><li><p>Derive from <code>ViewComponent</code></p><ul><li>Can also use name ending in <code>ViewComponent</code> or decorate with <code>[ViewComponent]</code></li></ul></li><li><p>Implement <code>InvokeAsync</code> and return <code>IViewComponentResult</code></p><ul><li>Any data needed for view passed into view as <code>viewmodel</code></li><li>Typically returns a partial view</li></ul></li><li><p>Create standard partial view: default name is <code>default.cshtml</code></p></li><li><p>Must locate partial view in:</p><ul><li><code>Views/[controller_name]/Components/[view_component_name]/[view_name]</code></li><li><code>Views/Shared/Components/[view_component_name]/[view_name]</code></li></ul></li><li><p>Invoke from a view (or layout)</p><ul><li><code>@Component.InvokeAsync(&quot;[name]&quot;, [anonymous type with parameters])</code></li></ul></li><li><p>Invoke from a controller action method: <code>return ViewComponent(&quot;[name]&quot;, [anonymous type with parameters]);</code></p></li><li><p><strong>Changed in 1.1:</strong></p><ul><li>Can be invoked as a Tag Helper from view (or layout)</li></ul></li></ul><h3 id="asp-net-core-1-1" tabindex="-1">ASP.NET Core 1.1 <a class="header-anchor" href="#asp-net-core-1-1" aria-label="Permalink to “ASP.NET Core 1.1”">​</a></h3><ul><li>Recommended for production</li><li>Entity Framework Core 1.1 (IMHO) is production ready <ul><li><p>Added/fixed features:</p><ul><li>Connection Resiliency</li><li>Explicit loading</li><li>Mapping to computed columns</li></ul></li><li><p>Additional features:</p><ul><li>Mapping to Fields</li><li><code>DbSet.Find</code></li></ul></li></ul></li></ul><p>View Components Invoked as Tag Helpers:</p><ul><li><p>Must be registered in <code>_ViewImports.cshtml</code></p></li><li><p><code>@addTagHelper *,[assembly name]</code></p></li><li><p>Pascal-cased names are changed to lower-kebab-case</p></li><li><p>For the view component and any parameter names</p></li><li><p>Tags start with <code>vc</code>: <code>&lt;vc:categories-as-menus/&gt;</code></p></li></ul><p>Configuration Updates</p><ul><li><p>Reload on change in <code>AddJsonFile</code></p><ul><li>Parameter existed in 1.0; only supported in 1.1 and later</li></ul></li><li><p><code>IOptionSnapshot</code>:</p><ul><li>Used for injection of custom settings classes into classes, methods, and views</li><li>Supports reload on change</li></ul></li></ul><p><strong>View Pre-Compilation</strong>:</p><ul><li><p>Views can now be compiled with application publication</p><ul><li>Requires <code>Microsoft.AspNetCore.Mvc.Razor.ViewComponent</code> package</li><li>Requires updating the project file: <code>&lt;MvcRazorCompileOnPublish&gt;true&lt;/MvcRazorCompileOnPublish&gt;</code></li></ul></li><li><p>2 Considerations:</p><ul><li>Resulting publication bundle is smaller</li><li>Views cannot be edited after pre-compilation</li></ul></li><li><p><strong>Updated in 2.0:</strong></p><ul><li>View are pre-compiled by default</li></ul></li></ul><p>WebListener Server for Windows:</p><ul><li><p>Runs on top of Windows <code>Http.Sys</code> kernel</p></li><li><p>Doesn&#39;t rely on IIS</p></li><li><p>Takes advantage of Windows-specific features</p></li><li><p>Requires <code>Microsoft.AspNetCore.Server.WebListener</code> package</p></li><li><p>Shipped as 1.0 and 1.1 releases</p></li><li><p><strong>Changed in 2.0:</strong></p><ul><li>Changed to <code>Http.Sys</code>, option expanded</li></ul></li></ul><p>Middleware Components:</p><ul><li>Middleware components handle requests and responses</li><li>Each component: <ul><li>Chooses to send the request to the next component or not</li><li>Can perform work before and after invoking the next component</li></ul></li><li><strong>Replaces <code>HTTPModules</code> and <code>HTTPHandlers</code></strong></li><li>Completely configured in code</li></ul><ol><li><p>URL Rewriting Middleware:</p><ul><li><p>Modifies a request URL based on set rules</p></li><li><p>Must add <code>Microsoft.AspNetCore.Rewrite</code> package</p></li><li><p>Capable of redirects (client-side) and rewrite (server-side)</p></li><li><p>Can be configured with:</p><ul><li>Text (regex, case sensitive)</li><li>IIS standard XML formatted rules or Apache Mod_Rewrite syntax</li><li>C# code (methods or classes)</li></ul></li><li><p><strong>Changed in 2.0:</strong></p><ul><li>Configuration of IIS and Apache rules</li></ul></li><li><p><strong>Changed in 2.1:</strong></p><ul><li>Addition of middleware to intelligently redirect to HTTPS</li></ul></li><li><p>Redirects are configured with regex, replacement, and status code</p><ul><li>Defaults to 302 (temporary) if status code is not supplied</li><li>Can also redirect to secure end point</li></ul></li><li><p>Rewrites are configured with regex, replacement, and whether or not to continue processing rules</p></li><li><p>Methods change the response through code</p></li><li><p>Can add classes that implement <code>IRule</code> interface</p></li></ul></li><li><p>Response Caching Middleware:</p><ul><li><p>Requires <code>Microsoft.AspNetCore.ResponseCaching</code> package</p></li><li><p>Add <code>services.AddResponseCaching()</code> in <code>ConfigureServices</code></p></li><li><p>Add <code>app.UseResponseCaching()</code> in <code>Configure</code></p></li><li><p>Use <code>[ResponseCache]</code> controller attribute</p></li><li><p>Options:</p><ul><li><code>UseCaseSensitivePaths(default=false)</code></li><li><code>MaximumBodySize(default=64MB)</code></li><li><code>SizeLimit(default=100MB)</code></li></ul></li><li><p><strong>Changed in 2.0:</strong></p><ul><li>Where it gets configured</li></ul></li></ul></li><li><p>Response Compression Middleware:</p><ul><li><p>Requires <code>Microsoft.AspNetCore.ResponseCompression</code> package</p></li><li><p>Add <code>services.AddResponseComporession()</code> in <code>ConfigureServices</code></p></li><li><p>Add <code>app.UseResponseCompression()</code> in <code>Configure</code></p></li><li><p>Configure compression provider (default is gzip)</p></li><li><p><strong>Note: Will fail if user agent contains &quot;AppleWebKit/537.36 (KHTML, like Gecko)&quot;</strong></p></li><li><p><strong>Changed in 2.0:</strong></p><ul><li>Where it gets configured</li></ul></li></ul></li><li><p>Middleware as MVC Filters:</p><ul><li><p>Filters have access to MVC context and constructs</p></li><li><p>Using middleware as filters provides same access</p><ul><li>Run in same stage as resources filters</li></ul></li><li><p>Create a class with <code>Configure</code> method</p></li><li><p>Add to controller/action using the <code>[MiddlewareFilter]</code> attribute</p></li></ul></li></ol><p><strong>WebSocket Support</strong>:</p><ul><li><p>Enables working directly with a socket connection</p><ul><li>Requires <code>Microsoft.AspNetCore.WebSockets</code> package</li></ul></li><li><p>Configure the middleware</p></li><li><p>Accept <code>WebSocketRequests</code></p></li><li><p>Send and Receive messages</p></li><li><p><strong>SignalR</strong> (.NET Core 3.0 or later) provides more power:</p><ul><li>Included in the <code>Microsoft.AspNetCore.App</code> shared framework</li><li><code>Microsoft.AspNetCore.SignalR.Client</code> package</li></ul></li><li><p><strong>Added in 2.1:</strong></p><ul><li>SignalR support</li></ul></li></ul><h3 id="asp-net-core-2-0" tabindex="-1">ASP.NET Core 2.0 <a class="header-anchor" href="#asp-net-core-2-0" aria-label="Permalink to “ASP.NET Core 2.0”">​</a></h3><p>Package/Runtime Update:</p><ul><li><p><code>Microsoft.AspNetCore.All</code> meta-package (.NET Core 2)</p><ul><li>Includes all ASP.NET Core, EF, and their internal/third-party dependencies</li></ul></li><li><p>.Net Core Runtime Store:</p><ul><li>Contains all packages (pre-compiled) from <code>Microsoft.AspNetCore.All</code> meta-package</li></ul></li><li><p>Package trimming (pre-release)</p><ul><li>Requires <code>Microsoft.Packaging.Tools.Trimming</code> package</li><li>Add <code>&lt;TrimUnusedDependencies&gt;True&lt;/TrimUnusedDependencies&gt;</code> to project file</li></ul></li></ul><p>Entity Framework Updates:</p><ul><li>Entity Framework DbContext pooling</li><li>Owned tables/table splitting</li><li>Like operator</li><li>Improved <a href="./../LINQ.html">LINQ</a> translation</li><li>Global query filters</li><li>String interpolation in raw SQL</li><li>Explicitly compiled queries</li><li>Scalar function mapping</li><li>And more</li></ul><p>Using Docker:</p><ul><li><p>Build a custom image based on an existing <code>aspnetcore</code> image</p><ul><li>Enable Docker support in the new project wizard</li><li>Add Docker support in VS 2017 through project context menu</li><li>Select the same target OS that Docker is targeting</li></ul></li><li><p>Docker doesn&#39;t use the <code>launchSettings.json</code></p></li><li><p>Configured through the Docker files</p></li><li><p>Docker-Compose project in startup project</p><ul><li>Switch to ASP.NET Core project to disable Docker</li></ul></li><li><p>Localhost:{ServicePort} is the window into your application</p></li></ul><p><code>WebHost.CreateDefaultBuilder</code>:</p><ul><li>Encapsulates the most common tasks: <ul><li><p>Configures Kestrel and IISIntegration</p></li><li><p>Sets content root directory</p></li><li><p>Loads configuration from:</p><ul><li><code>appsettings.json/appsettings.{environmentname}.json</code></li><li>User secrets (in development)</li><li>Environment variables/command-line arguments</li></ul></li><li><p>Configures logging for console and debug logging using filtering rules from <code>appsettings</code></p></li><li><p>Can add additional configuration, logging providers, and servers</p></li><li><p>Can execute <code>Configure</code> and <code>ConfigureServices</code> directly from the WebHostBuilder without having to use a startup class.</p></li></ul></li></ul><p>Configuration Updates:</p><ul><li>Configuration is built in <code>Program.cs</code> by <code>CreateDefaultBuilder</code></li><li><code>IConfiguration</code> is added to DI container <ul><li>Injected into constructor for <code>Startup.cs</code></li></ul></li><li>Additional configuration can be added using WebHostBuilder <ul><li><code>ConfigureAppConfiguration((context, config) =&gt; {})</code></li></ul></li></ul><p>Logging Changes:</p><ul><li><p>Default logging is configured in <code>Program.cs</code> by <code>CreateDefaultBuilder</code></p></li><li><p>Log filters can be configured in:</p><ul><li><code>appsettings.json</code></li><li>Through code</li></ul></li><li><p>Additional logging providers can be added using WebHostBuilder</p><ul><li><code>ConfigureAppLogging((context, logging) =&gt; {})</code></li></ul></li></ul><p><strong><code>Http.Sys</code>:</strong></p><ul><li><p>Renamed from WebListener (introduced in 1.1)</p></li><li><p>Requires <code>Microsoft.AspNetCore.Server.HttpSys</code> package; merger of:</p><ul><li><code>Microsoft.AspNetCore.Server.WebListener</code></li><li><code>Microsoft.Net.Http.Server</code></li></ul></li><li><p>Configurable options:</p></li><li><p>Authentication</p></li><li><p>Max client connections</p></li><li><p>Max request body size</p></li><li><p>URL prefixes</p></li><li><p><strong>Can&#39;t use with IIS</strong></p></li></ul><p>Rewriting Middleware Updates:</p><ul><li><p>Changes to how IIS and Apache rules are acquired</p></li><li><p>Additional IIS URL Rewrite Module features are supported:</p><ul><li>Global rules</li><li>Rewrite maps</li><li>CustomResponse action</li><li>Action: CustomResponse</li></ul></li><li><p><strong>Changed in 2.1:</strong></p><ul><li>Addition of middleware to intelligently redirect to HTTPS</li></ul></li></ul><p>Kestrel Updates:</p><ul><li>Improvements to make it more suitable as an internet facing server</li><li>Added server limits for: <ul><li>Max client connections</li><li>Max request body size</li><li>Min request body data rate</li></ul></li><li>Now uses a Listen (ListenUnixSocket) <ul><li>Can&#39;t use <code>UseUrls</code> for HTTPS</li></ul></li></ul><p>Using SSL Locally: Kestrel</p><ul><li><p>Same as in 1.1</p></li><li><p>No need to create X506 certificate</p></li><li><p>Copy <code>.pfx</code> to project</p></li><li><p>Add Listen options to <code>UseKestrel()</code></p></li><li><p>Configure HTTP and HTTPS</p></li><li><p>Add SSLPort to MVC</p></li><li><p><strong>Changed in 2.1:</strong></p><ul><li>Development certificate is created when .NET Core SDK is installed</li><li>Development certificate is trusted through VS or .NET Core CLI</li></ul></li></ul><p>SSL in Docker:</p><ul><li><p>Enable SSL in Kestrel</p></li><li><p>Map entry ports to 80, 443 in <code>docker-compose.override.yml</code></p><ul><li><code>8080:80</code></li><li><code>44300:443</code></li></ul></li><li><p>Set SSL Port in MVC to Docker Port (44300)</p></li><li><p>Set service URL in docker-compose project</p></li></ul><p><strong>Razor Pages</strong>:</p><ul><li><p>Razor Pages are designed for creating page-focused scenarios</p></li><li><p>Less overhead than MVC</p></li><li><p>Enabled alongside MVC</p><ul><li>All part of the same framework</li><li>Framework looks for Razor Pages in the <code>Pages/</code> folder by default</li></ul></li><li><p>Declared with <code>@page</code> directive, operates as an action:</p><ul><li>Requests don&#39;t go through a controller</li><li>Use code behind files for C# code</li></ul></li><li><p>Support model binding, Tag Helpers, HTML Helpers</p></li></ul><h3 id="asp-net-core-2-1" tabindex="-1">ASP.NET Core 2.1 <a class="header-anchor" href="#asp-net-core-2-1" aria-label="Permalink to “ASP.NET Core 2.1”">​</a></h3><p>Compatibility Version:</p><ul><li><code>SetCompatibilityVersion</code> method allows for opt-in or opt-out of potentially breaking pages</li><li>opting in produces the latest behaviour</li><li>Default for 2.0 and 2.1 apps is 2.0 compatibility</li><li>Set in <code>ConfigureServices()</code><ul><li><code>services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);</code></li></ul></li></ul><p><code>Microsoft.AspNetCore.All</code> meta-package:</p><ul><li>This new package includes all supported packages by: <ul><li>ASP.NET Core team</li><li>EF Core Team</li><li>Plus Json.NET, Remotion.Linq, and lx-Async</li></ul></li></ul><p>Client Libraries and Library Manger:</p><ul><li><p>VS 2017 (15.8+) added Library Manger</p></li><li><p>Which is similar to GulpJS, GruntJS, webpack, npm</p></li><li><p>Why Library Manger?</p><ul><li>Not currently using an open-source tool</li><li>Need/want complete control over the file destination</li><li>Smaller footprint for libraries</li><li>Loads only specified files</li></ul></li><li><p>Add specific files and versions from cdnjs, unpkg, or the filesystem</p></li><li><p>IntelliSense in <code>libman.json</code></p></li><li><p>Clean/restore on build</p></li><li><p>GUI for building <code>libman.json</code></p></li><li><p>Install <code>LibMan</code> as a global tool</p></li><li><p><code>dotnet tool install -g Microsoft.Web.LibraryManager.CLI</code></p></li><li><p>Execute the appropriate command</p><ul><li><code>init</code>, <code>[un]install</code>, <code>clean</code>, <code>restore</code>, <code>update</code></li><li><code>libman install ../../ --provider filesystem --files test.js --destination wwwroot/lib/test</code></li></ul></li></ul><p>SignalR Features:</p><ul><li>Handle connection management automatically</li><li>Send messages to all connected clients automatically</li><li>Send messages to specific clients or groups of clients</li><li>Scales to handle increased traffic</li></ul><p>SignalR Mechanics:</p><ul><li>ASP.NET Core SignalR uses WebSockets to handle real-time communications.</li><li>Hubs are used to communicate between the clients and the servers.</li><li>SignalR handles the dispatching across machine boundaries <ul><li>Allowing clients to call the server and vice versa</li></ul></li></ul><p>SignalR Hub Protocols:</p><ul><li>Text protocol based on JSON</li><li>Binary protocol based on MessagePack</li><li>Older browsers must support XHR Level 2 to provide MessagePack support</li></ul><p>Implementing SignalR:</p><ul><li><p>SignalR server library is in <code>Microsoft.AspNetCore.App</code></p></li><li><p>Add SignalR client library using Library Manager</p><ul><li><code>@aspnet/signalR</code> from unpkg</li></ul></li><li><p>Create a SignalR hub</p></li><li><p>Enable CORS as necessary</p></li></ul><p><strong>ApiController</strong> Attribute:</p><ul><li><p>APIController attribute + ControllerBase --&gt; Enables REST behaviours</p></li><li><p>Automatic HTTP 400 (Bad Request) with invalid ModelState</p><ul><li>Customizable with <code>InvalidModelStateResponseFactory</code></li></ul></li><li><p>Multipart/form-data request inference</p></li><li><p>Binding source parameter inference</p></li></ul><p>Binding Source Parameter inference:</p><ul><li>Complex types --&gt; FormBody</li><li>IFormFile, IFormFileCollection --&gt; FromForm</li><li>Values matching the route --&gt; FromRoute</li><li>All others --&gt; FromQuery</li></ul><p>Razor Pages Improvements:</p><ul><li><p>Razor Pages increased search area:</p><ul><li>Current Pages folder</li><li><code>/Pages/Shared</code></li><li><code>/Views/Shared</code></li></ul></li><li><p>Razor Pages support areas</p></li></ul><p><strong>Razor Class Libraries</strong>:</p><ul><li>Razor-based UIs can be distributed as a library <ul><li>Share across multiple projects</li><li>App startup time is improved</li><li>Views and pages are automatically discovered</li><li>Views and pages can be overwritten by the app</li></ul></li><li>They can include: <ul><li>Razor views</li><li>Pages</li><li>Controllers</li><li>View components</li><li>Models (page and data)</li></ul></li></ul><p>HTTPS and Security Middleware:</p><ul><li><code>app.UseHttpsRedirection()</code> replaces <code>RequireHttpsAttribute</code></li><li>Creates a temporary redirect (307), best for development</li><li>Configures a permanent redirect for production</li><li>Trust the development certificate: <code>dotnet dev-certs https --trust</code></li></ul><p>Kestrel listens on port <code>https://*:5001</code> with local development certificate</p><p>EU General Data Protection Regulation (GDPR):</p><ul><li><p>Rules to protect EU citizens from privacy and data breaches</p></li><li><p>Applies to all companies that process data for EU citizens</p></li><li><p>All websites should consider GDPR compliance</p></li><li><p>ASP.NET Core 2.1 GDPR Support:</p><ul><li>Configurable cookie policy options</li><li>Cookie consent partial view</li><li>User download/deletion of personal data</li><li>Privacy policy page</li></ul></li><li><p>Enabled with <code>app.UseCookiePolicy</code>:</p><ul><li>Enables consent pop-up window</li><li>Disables non-essential cookies</li><li>Sets cookie <code>AspNet.Consent</code>: <ul><li>Values (yes || no)</li><li>SameSite=Lax (default)</li><li>Expiration (current time + 5 hrs)</li><li>Secure if HTTPS request</li></ul></li></ul></li></ul><h3 id="asp-net-core-2-2" tabindex="-1">ASP.NET Core 2.2 <a class="header-anchor" href="#asp-net-core-2-2" aria-label="Permalink to “ASP.NET Core 2.2”">​</a></h3><ul><li><p>To adopt the in-process hosting model for IIS, add the <code>&lt;AspNetCoreHostingModel&gt;</code> property with a value of InProcess to a <code>&lt;PropertyGroup&gt;</code> in the project file</p></li><li><p><code>ConfigureKestrel</code></p></li><li><p>If your app does logging provider initialization, filtering, and configuration loading in the <code>Startup</code> class, move that code to <code>Program.Main</code>:</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> Main</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">[]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> args</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">    var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> webHost</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;"> WebHostBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">        // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">ConfigureLogging</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">((</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">hostingContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> logging</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">            logging</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddConfiguration</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">hostingContext</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">GetSection</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Logging</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">            logging</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddConsole</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">                   .</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">AddFilter</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">ConsoleLoggerProvider</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">                       (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">category</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#CB7676;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> level</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> LogLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Information</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">                   // or</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">                   .</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">AddFilter</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">ConsoleLoggerProvider</span><span style="--shiki-light:#D73A49;--shiki-dark:#666666;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">                       ((</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">category</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> level</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> category</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> ==</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">A</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> ||</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">                           level</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> ==</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;"> LogLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">Critical</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;">            )</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">        })</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">        // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p><code>System.Text.Json</code> supports asynchronous serialization</p></li></ul><h3 id="asp-net-core-3-0" tabindex="-1">ASP.NET Core 3.0 <a class="header-anchor" href="#asp-net-core-3-0" aria-label="Permalink to “ASP.NET Core 3.0”">​</a></h3><ul><li>Remove <code>&lt;AspNetCoreHostingModel&gt;</code> element</li><li>Remove <code>&lt;Microsoft.AspNetCore.App&gt;</code> and <code>Microsoft.AspNetCore.Razor.Design</code></li><li><code>services.AddMvc</code> to <code>services.AddRazorPages</code></li><li>No need to set <code>CompatibilityVersion</code> in <code>services.AddMvc</code></li><li>Added <code>app.UseAuthorization()</code></li><li>Use <code>app.UseEndpoints</code></li><li>Default to the in-process hosting model in ASP.NET Core 3.0 or later</li></ul><h3 id="asp-net-core-3-1" tabindex="-1">ASP.NET Core 3.1 <a class="header-anchor" href="#asp-net-core-3-1" aria-label="Permalink to “ASP.NET Core 3.1”">​</a></h3><h3 id="asp-net-core-5-0" tabindex="-1">ASP.NET Core 5.0 <a class="header-anchor" href="#asp-net-core-5-0" aria-label="Permalink to “ASP.NET Core 5.0”">​</a></h3><ul><li>Integration of OpenAPI V3.0 (Swagger)</li><li><code>F5</code>: opens swagger page (<code>localhost:44315/swagger/index.html</code>)</li><li><code>NSwag</code>: Generates HTTPClient from the <code>swagger.json</code> output</li></ul><h3 id="asp-net-core-6-0" tabindex="-1">ASP.NET Core 6.0 <a class="header-anchor" href="#asp-net-core-6-0" aria-label="Permalink to “ASP.NET Core 6.0”">​</a></h3><ul><li>Implicit <code>using</code> directive</li></ul>`,259)]])}var s=r(a,[[`render`,o]]);export{i as __pageData,s as default};