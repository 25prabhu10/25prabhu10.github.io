import{A as e,d as t,m as n}from"./chunks/runtime-core.esm-bundler.BXAIOQQS.js";import{t as r}from"./chunks/plugin-vue_export-helper.CtN8rQnz.js";const i=JSON.parse(`{"title":"ASP.NET Core MVC","description":"ASP.NET Core's implementation of MVC","frontmatter":{"title":"ASP.NET Core MVC","description":"ASP.NET Core's implementation of MVC"},"headers":[],"relativePath":"Languages/C-Sharp/ASP_NET/ASP_NET_Core_MVC.md","filePath":"Languages/C-Sharp/ASP_NET/ASP_NET_Core_MVC.md","lastUpdated":1756574703000}`);var a={name:`Languages/C-Sharp/ASP_NET/ASP_NET_Core_MVC.md`};function o(r,i,a,o,s,c){return e(),t(`div`,null,[...i[0]||=[n(`<h1 id="asp-net-core-mvc" tabindex="-1">ASP.NET Core MVC <a class="header-anchor" href="#asp-net-core-mvc" aria-label="Permalink to “ASP.NET Core MVC”">​</a></h1><h2 id="mvc-design-pattern" tabindex="-1">MVC Design Pattern <a class="header-anchor" href="#mvc-design-pattern" aria-label="Permalink to “MVC Design Pattern”">​</a></h2><p>Model-View-Controller (MVC) is a user interface design pattern</p><ul><li>Promotes separation of concerns across multiple application layers</li></ul><p>The MVC design pattern helps to enforce separation of concerns to help you avoid mixing presentation logic, business logic, and data access logic together.</p><ul><li><p>Model: classes (objects)</p><ul><li>All business logic <ul><li>Business processes</li><li>Validation rules</li><li>Systems integration</li></ul></li></ul></li><li><p>View: web pages (Razor HTML)</p><ul><li>Very little logic</li></ul></li><li><p>Controller: connects models, business logic and web pages</p><ul><li>Controls application workflow</li><li>Orchestrates interaction between the model and the view</li></ul></li></ul><p>How website works:</p><ul><li>User requests a web-page / API through an URL</li><li>ASP.NET will intercept this call through a Router</li><li>Router will send the information present in the request to the Controller</li><li>Controller will use the Model to get data from the Database and process this data</li><li>After processing the data Controller will send this data to the View</li><li>View will generate the HTML page with the data it receives and servers it back to the user</li></ul><h3 id="asp-net-mvc" tabindex="-1">ASP.NET MVC <a class="header-anchor" href="#asp-net-mvc" aria-label="Permalink to “ASP.NET MVC”">​</a></h3><ul><li><p>Add the MVC middleware <code>app.UseMvc()</code>, along with route patterns that the ASP.NET Core MVC middleware should be listening to.</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseMvc</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">routes</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    routes</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MapRoute</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">Default</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">{controller=Home}/{actions=Index}/{id?}</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// Core 3.x +</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">UseEndpoints</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">endpoints</span><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;"> =&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    endpoints</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">MapControllers</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">default</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">{controller=Home}/{action=Index}</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">});</span></span></code></pre></div></li><li><p>Add the services MVC requires (DI): 3-5 were added in Core 3.x</p><ol><li><p><code>AddMvcCore()</code>: Only adds core components of the MVC pipeline, requiring you to add any other middleware (needed for your project) by yourself.</p><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;">// MVC Core</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> ConfigureServices</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IServiceCollection</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddMvcCore</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddViews</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddRazorViewEngine</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddDataAnnotations</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">()</span><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"> // for model validation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddApiExplorer</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"> // for Swagger</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p><code>AddMvc()</code>: Internally calls <code>AddMvcCore()</code> and adds other middleware such as the Razor view engine, Razor pages, CORS, cache tag helper, JSON formatter (in Core 2.x), data annotations etc.</p><ul><li>everything that <code>AddControllersWithViews()</code> does</li><li>everything that <code>AddRazorPages()</code> does</li></ul><div class="language-cs"><button title="Copy Code" class="copy"></button><span class="lang">cs</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#CB7676;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#4D9375;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> ConfigureServices</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#5DA994;">IServiceCollection</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;"> services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#BD976A;">    services</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">AddMvc</span><span style="--shiki-light:#24292E;--shiki-dark:#666666;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#666666;">}</span></span></code></pre></div></li><li><p><code>AddControllers()</code>: Everything that <code>AddMvcCore()</code> does and (Better suited for API apps):</p><ul><li>authorization services: needed for authorization policies, filters and other authorization components to work</li><li>API explorer: required if you want to build dynamic API documentation, generate Swagger/OpenAPI files</li><li>data annotations: needed for model validation with attributes and IValidateableObject to work</li><li>formatter mappings: needed for content negotiation to work</li><li>CORS</li></ul></li><li><p><code>AddControllersWithViews()</code>: Everything that <code>AddControllers()</code> does and (building a &quot;classic&quot; MVC site):</p><ul><li>views functionality: explicitly registers the Razor view engine</li><li>cache tag helper</li></ul></li><li><p><code>AddRazorPages()</code>: Everything that <code>AddMvcCore()</code> does and:</p><ul><li>all the core Razor pages features</li><li>authorization services</li><li>data annotations</li><li>cache tag helper</li></ul></li></ol></li><li><p><a href="https://www.strathweb.com/2020/02/asp-net-core-mvc-3-x-addmvc-addmvccore-addcontrollers-and-other-bootstrapping-approaches/" target="_blank" rel="noreferrer">ASP.NET Core MVC 3.x - AddMvc(), AddMvcCore(), AddControllers() and other bootstrapping approaches</a></p></li></ul><h3 id="controllers" tabindex="-1">Controllers <a class="header-anchor" href="#controllers" aria-label="Permalink to “Controllers”">​</a></h3><p>They are responsible for receiving the request and figuring out what to do with it. In an ASP.NET Core MVC application, controllers are nothing more than classes.</p><ul><li>They contain actions (methods)</li></ul><h2 id="razor-pages-application" tabindex="-1">Razor Pages Application <a class="header-anchor" href="#razor-pages-application" aria-label="Permalink to “Razor Pages Application”">​</a></h2><p>Razor is a template markup syntax.</p><ul><li>Introduced in ASP.NET Core 2.0</li><li>Routing, Models, <code>ActionResult</code>, Tag Helpers...</li><li>Razor Pages have two parts: <ol><li>Razor Page (UI/View)</li><li>Page Model (Contains Handlers)</li></ol></li></ul><p>The <code>View()</code> looks for <code>.cshtml</code> files in the Views directory. It first checks for a directory with the same name as the controller. In that directory it checks for the file with the same name as the action calling the view. If not it will look into the <code>Shared</code> directory</p><h3 id="syntax" tabindex="-1">Syntax <a class="header-anchor" href="#syntax" aria-label="Permalink to “Syntax”">​</a></h3><ul><li>HTML is a valid in Razor pages</li><li><code>@</code>: Is prefixed to C# code, e.g. <code>@DateTime.Now.Year</code></li></ul><p>HTML helpers:</p><ul><li><code>@Html.ActionHelper</code></li><li><code>@Url.Action</code></li></ul><div class="tip custom-block"><p class="custom-block-title">Note</p><p><code>Microsoft.AspNetCore.App</code> was the meta-package which contained all features of .NET Core</p><ul><li>Prior to .NET Core 3, meta-package was included as a Nuget Package.</li><li>With .NET Core 3 onwards, meta-package is a part of .NET Core installation itself, the package have been moved out of the meta-package as a separate Nuget Package, like Entity Framework.</li></ul></div><h2 id="project" tabindex="-1">Project <a class="header-anchor" href="#project" aria-label="Permalink to “Project”">​</a></h2><ol><li><p>Create a ASP.NET Core project:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light vitesse-dark" style="--shiki-light:#24292e;--shiki-dark:#dbd7caee;--shiki-light-bg:#fff;--shiki-dark-bg:#121212;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"># ASP.NET Core Empty</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">dotnet</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> web</span><span style="--shiki-light:#005CC5;--shiki-dark:#C99076;"> -n</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> [project </span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">name]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#758575DD;"># ASP.NET Core Web App (MVC)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#80A665;">dotnet</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;"> MVC</span><span style="--shiki-light:#005CC5;--shiki-dark:#C99076;"> -n</span><span style="--shiki-light:#24292E;--shiki-dark:#DBD7CAEE;"> [project </span><span style="--shiki-light:#032F62;--shiki-dark:#C98A7D;">name]</span></span></code></pre></div></li></ol><ul><li>For Login user <a href="https://stackoverflow.com/questions/53854051/usermanager-checkpasswordasync-vs-signinmanager-passwordsigninasync" target="_blank" rel="noreferrer">UserManager.CheckPasswordAsync vs SignInManager.PasswordSignInAsync</a></li></ul><h3 id="project-structure-of-razor-pages" tabindex="-1">Project Structure of Razor Pages <a class="header-anchor" href="#project-structure-of-razor-pages" aria-label="Permalink to “Project Structure of Razor Pages”">​</a></h3><p>Check <a href="./ASP_NET_Core.html#aspnet-core-project-structure">Core Project Structure</a></p><ol><li><p>Create an ASP.NET Core Web Application MVC (Razor Pages).</p></li><li><p><code>[project name].csproj</code></p></li><li><p><code>Properties/launchSettings.json</code></p></li><li><p><code>wwwroot/</code>: folder will contain all the static files like CSS, JavaScript, image files, and libraries. This addresses separation of concerns.</p></li><li><p><code>Pages/</code>: is the main folder in a Razor Project. This folder contains all the pages (views) of the application.</p><ul><li>There is a <em>Shared</em> folder inside, which contains <code>.cshtml</code> files with <code>_</code> prefix. These files are known as <strong>partial view</strong> files. They act as components.</li><li><code>_ViewImports.cshtml</code> - Contains tag helper. This contains global tags, you can define page specific tags inside the specific page folder.</li><li><code>_ViewStart.cshtml</code> - Defines the master page. Like the layout for all the pages.</li><li>The rest of the <code>.cshtml</code> files in Pages are Razor Pages And other <code>.cshtml</code> files have a <code>.cshtml.cs</code> file, which is the modal for the view.</li><li><code>index.cshtml</code> file is the homepage of the application.</li></ul></li><li><p><code>Views/</code></p></li></ol><h2 id="middleware" tabindex="-1">Middleware <a class="header-anchor" href="#middleware" aria-label="Permalink to “Middleware”">​</a></h2><p>Check <a href="./ASP_NET_Core.html#middleware-in-aspnet-core">ASP.NET Core Middleware</a></p><h3 id="serve-static-files" tabindex="-1">Serve Static Files <a class="header-anchor" href="#serve-static-files" aria-label="Permalink to “Serve Static Files”">​</a></h3><p>Static files are stored within the project&#39;s web root directory. The default directory is <code>{content root}/wwwroot</code>, but it can be changed with the <code>UseWebRoot</code> method.</p><p><code>wwwroot</code> folder structure:</p><ul><li><code>css</code></li><li><code>js</code></li><li><code>lib</code></li><li><code>images</code></li></ul><p>Use <code>app.UseStaticFiles()</code> method to serve static files from this directory</p><p>Other methods:</p><ul><li><p><code>app.UseDirectoryBrowser</code>: Allows directory listing within specified directories. Disabled by default for security reasons. Add <code>services.AddDirectoryBrowser()</code></p></li><li><p><code>app.UseDefaultFiles()</code>: Serve a default file from <code>wwwroot</code> without requiring the request URL to include the file&#39;s name:</p><ul><li><code>UseDefaultFiles</code> must be called before <code>UseStaticFiles</code></li><li>It checks for: <ul><li><code>default.htm</code></li><li><code>default.html</code></li><li><code>index.htm</code></li><li><code>index.html</code></li></ul></li></ul></li><li><p><code>app.UseFileServer()</code>: Combines the functionality of <code>UseStaticFiles</code>, <code>UseDefaultFiles</code>, and optionally <code>UseDirectoryBrowser</code></p></li></ul><h2 id="error-handling" tabindex="-1">Error Handling <a class="header-anchor" href="#error-handling" aria-label="Permalink to “Error Handling”">​</a></h2><h3 id="global-exception-handling" tabindex="-1">Global Exception Handling <a class="header-anchor" href="#global-exception-handling" aria-label="Permalink to “Global Exception Handling”">​</a></h3><ul><li><p>Add <code>app.UseDeveloperExceptionPage()</code> to get stack trace and other diagnostic details in the error page. Use this only in <strong>Development environment</strong></p></li><li><p>In production, use <code>app.UseExceptionHandler(&quot;/Error&quot;)</code>. This middleware listens for any unhandled exceptions that may occur during the course of a request, then logs the error and redirects the request to a friendly error page</p></li></ul><h2 id="routing-in-razor-pages" tabindex="-1">Routing in Razor Pages <a class="header-anchor" href="#routing-in-razor-pages" aria-label="Permalink to “Routing in Razor Pages”">​</a></h2><ul><li><p>Routing in ASP.NET Razor Pages maps URL&#39;s to physical files on disk.</p></li><li><p><em>Pages</em> is the root folder where <code>index.cshtml</code> (default document) file resides. You can change the root folder in <code>ConfigureServices</code> in <code>Startup.cs</code> file.</p></li><li><p>File extensions are not included in the URL.</p></li></ul><table tabindex="0"><thead><tr><th>URL</th><th>Maps TO</th></tr></thead><tbody><tr><td><code>www.domain.com</code></td><td><code>/Pages/index.cshtml</code></td></tr><tr><td><code>www.domain.com/index</code></td><td><code>/Pages/index.cshtml</code></td></tr><tr><td><code>www.domain.com/account</code></td><td><code>/Pages/account.cshtml</code> or <code>/Pages/account/index.cshtml</code></td></tr><tr><td><code>www.domain.com/invalidURL</code></td><td><code>/Pages/index.cshtml</code> <em>(default path)</em></td></tr></tbody></table><h2 id="tag-helpers" tabindex="-1">Tag Helpers <a class="header-anchor" href="#tag-helpers" aria-label="Permalink to “Tag Helpers”">​</a></h2><p>Tag Helpers enable server-side code to participate in creating and rendering HTML elements in Razor files. HTML Helpers alternative.</p>`,45)]])}var s=r(a,[[`render`,o]]);export{i as __pageData,s as default};